"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6947],{3364:(M,m,d)=>{d.d(m,{a:()=>C});var _=d(591),c=d(1737),a=d(4850),l=d(7221),f=d(2868),o=d(7631),G=d(1102);let C=(()=>{class u{constructor(i){this.rest=i,this.isLoadingMore=!1,this.selectPhotoGradeStateSubject=new _.X(null)}get selectedPhotoGrade(){return this.selectPhotoGradeStateSubject.value}set setSelectedPhotoGrade(i){this.selectPhotoGradeStateSubject.next(i)}submitPhotoGrade(i){return this.rest.post({endpoint:"/photogrades",params:{fullNess:i.fullNess,comments:i.notes}},i.formData,!1,!0).pipe((0,a.U)(r=>{const{data:p}=r.body;return p}),(0,l.K)(r=>(0,c._)(r))).toPromise()}photoGradeList(i){return this.rest.get({endpoint:"/photogrades",params:i}).pipe((0,a.U)(r=>{const{data:p,pagination:P}=r.body;return{data:p,pagination:P}}),(0,l.K)(r=>(0,c._)(r))).toPromise()}photoGradeCompletedList(i){return this.rest.get({endpoint:"/photogrades/completed",params:i}).pipe((0,a.U)(r=>{const{data:p,pagination:P}=r.body;return{data:p,pagination:P}}),(0,l.K)(r=>(0,c._)(r))).toPromise()}photoGrade(i){return this.rest.get({endpoint:`/photogrades/${i}`}).pipe((0,a.U)(r=>{const{data:p}=r.body;return p}),(0,l.K)(r=>(0,c._)(r))).toPromise()}photoGradeImgUrl(i){return this.rest.get({endpoint:"/photogrades/presigned-url",params:{fileKey:i}}).pipe((0,a.U)(r=>{const{data:p}=r.body;return p}),(0,l.K)(r=>(0,c._)(r))).toPromise()}nextPhotoGrade(i){return this.isLoadingMore=!0,this.rest.get({endpoint:i,server:"none"}).pipe((0,a.U)(r=>{const{data:p,pagination:P}=r.body;return{data:p,pagination:P}}),(0,f.b)(()=>this.isLoadingMore=!1),(0,l.K)(r=>(0,c._)(r))).toPromise()}deletePhotoGrade(i){return this.rest.delete(`/photogrades/${i}`).pipe((0,a.U)(r=>{const{data:p}=r.body;return p}),(0,l.K)(r=>(0,c._)(r))).toPromise()}}return u.\u0275fac=function(i){return new(i||u)(o.LFG(G.v))},u.\u0275prov=o.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},6947:(M,m,d)=>{d.r(m),d.d(m,{CreatePhotoGradePageModule:()=>E});var _=d(6895),c=d(4719),a=d(2478),l=d(1065),f=d(5861),o=d(7631),G=d(3364),C=d(5904),u=d(3710);function v(e,h){if(1&e){const t=o.EpF();o.TgZ(0,"div",2),o._UZ(1,"ion-img",3),o.TgZ(2,"ion-icon",4),o.NdJ("click",function(){o.CHM(t);const s=o.oxw();return o.KtG(s.onRemovePhotoGrade())}),o.qZA()()}if(2&e){const t=o.oxw();o.xp6(1),o.Q6J("src",t.photoDataUrl)}}function i(e,h){if(1&e){const t=o.EpF();o.TgZ(0,"ion-button",5),o.NdJ("click",function(){o.CHM(t);const s=o.oxw();return o.KtG(s.addPhotoGrade())}),o.TgZ(1,"div"),o._UZ(2,"ion-icon",6)(3,"br"),o.TgZ(4,"ion-text"),o._uU(5,"Add Photo"),o.qZA()()()}}let r=(()=>{class e{constructor(t){this.photo=t,this.photoDataUrl="",this.add=new o.vpe,this.remove=new o.vpe}ngOnInit(){}addPhotoGrade(){var t=this;return(0,f.Z)(function*(){const n=yield t.photo.promptPhoto();t.currentPhoto=n,t.add.emit(t.currentPhoto)})()}onRemovePhotoGrade(){this.remove.emit(this.currentPhoto),this.currentPhoto=null}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(u.T))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-upload-photo-grade"]],inputs:{photoDataUrl:"photoDataUrl"},outputs:{add:"add",remove:"remove"},decls:2,vars:2,consts:[["class","current-photo-container",4,"ngIf"],["expand","block","color","dark","class","add-photo-button ion-margin-end",3,"click",4,"ngIf"],[1,"current-photo-container"],[1,"grade-photo","ion-margin-end",3,"src"],["name","trash","color","danger",1,"trash-icon",3,"click"],["expand","block","color","dark",1,"add-photo-button","ion-margin-end",3,"click"],["src","/assets/icon/add-photo.svg",1,"add-photo-icon"]],template:function(t,n){1&t&&(o.YNc(0,v,3,1,"div",0),o.YNc(1,i,6,0,"ion-button",1)),2&t&&(o.Q6J("ngIf",n.photoDataUrl),o.xp6(1),o.Q6J("ngIf",!n.photoDataUrl))},dependencies:[_.O5,a.YG,a.gu,a.Xz,a.yW],styles:[".add-photo-button[_ngcontent-%COMP%]{--background: #fff;width:104px;height:83px}.grade-photo[_ngcontent-%COMP%]{width:104px;height:83px;background:#000}.add-photo-icon[_ngcontent-%COMP%]{--color: #000;width:26px;height:26px}.current-photo-container[_ngcontent-%COMP%]{position:relative}.trash-icon[_ngcontent-%COMP%]{position:absolute;top:2px;left:5px}"]}),e})();function p(e,h){if(1&e){const t=o.EpF();o.TgZ(0,"app-upload-photo-grade",8),o.NdJ("add",function(s){o.CHM(t);const g=o.oxw();return o.KtG(g.onAddPhoto(s,1))})("remove",function(){o.CHM(t);const s=o.oxw();return o.KtG(s.onRemovePhotoGrade(1))}),o.qZA()}if(2&e){const t=o.oxw();o.Q6J("photoDataUrl",t.photoGradeDataUrl[1])}}function P(e,h){if(1&e){const t=o.EpF();o.TgZ(0,"app-upload-photo-grade",8),o.NdJ("add",function(s){o.CHM(t);const g=o.oxw();return o.KtG(g.onAddPhoto(s,2))})("remove",function(){o.CHM(t);const s=o.oxw();return o.KtG(s.onRemovePhotoGrade(2))}),o.qZA()}if(2&e){const t=o.oxw();o.Q6J("photoDataUrl",t.photoGradeDataUrl[2])}}function U(e,h){1&e&&(o.TgZ(0,"ion-text",19)(1,"small"),o._uU(2," Please add a photo."),o.qZA()())}const T=[{path:"",component:(()=>{class e{constructor(t,n,s,g,x,O){this.photoGradeService=t,this.accountService=n,this.photoService=s,this.loadingCtrl=g,this.toastCtrl=x,this.route=O,this.fullness=100,this.notes="",this.photoGrade=[],this.photoGradeDataUrl=[],this.showError=!1}ngOnInit(){}submitGrading(){var t=this;return(0,f.Z)(function*(){if(t.photoGradeDataUrl.length){const n=yield t.loadingCtrl.create({message:"Submitting photo grade ..."});n.present();const s=new FormData;t.photoGrade.forEach(x=>{s.append("photoGrades",x)}),yield t.photoGradeService.submitPhotoGrade({fullNess:t.fullness,notes:t.notes,formData:s}),yield t.accountService.user(t.accountService.currentUser.id.toString()),n.dismiss(),(yield t.toastCtrl.create({message:"Successfully submited photo grade.",duration:2e3,color:"success"})).present(),t.route.navigate(["/tabs/tabs/photo-grade"])}else t.showError=!0})()}onAddPhoto(t,n){this.photoGradeDataUrl[n]=t.dataUrl,this.photoGrade[n]=this.photoService.dataURItoBlob(t.dataUrl)}onRemovePhotoGrade(t){this.photoGrade.splice(t,1),this.photoGradeDataUrl.splice(t,1)}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(G.a),o.Y36(C.B),o.Y36(u.T),o.Y36(a.HT),o.Y36(a.yF),o.Y36(l.F0))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-create-photo-grade"]],decls:38,vars:7,consts:[["mode","ios"],["slot","start"],["mode","md"],[1,"ion-padding"],[1,"ion-text-center","ion-margin-bottom"],[1,"paragraph-text-16-bold"],[1,"ion-margin-bottom"],[1,"box-flex"],[3,"photoDataUrl","add","remove"],[3,"photoDataUrl","add","remove",4,"ngIf"],["color","danger",4,"ngIf"],["position","stacked",1,"white","paragraph-text-14-bold"],[1,"ion-align-items-center","lot-range"],["mode","ios","min","0","max","100","step","10",3,"pin","ngModel","ngModelChange"],["slot","start",1,"white-500"],["slot","end",1,"white-500"],["placeholder","Enter any notes","rows","6",1,"lot-input",3,"ngModel","ngModelChange"],["expand","block",1,"submit-grading-button",3,"click"],[1,"paragraph-text-16-semibold","white"],["color","danger"]],template:function(t,n){1&t&&(o.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),o._UZ(3,"ion-back-button",2),o.qZA(),o.TgZ(4,"ion-title"),o._uU(5,"New Photo Grade"),o.qZA()()(),o.TgZ(6,"ion-content",3)(7,"div",4)(8,"ion-text",5),o._uU(9,"Add up to Three Photos"),o.qZA()(),o.TgZ(10,"ion-grid")(11,"ion-row",6)(12,"ion-col")(13,"div",7)(14,"app-upload-photo-grade",8),o.NdJ("add",function(g){return n.onAddPhoto(g,0)})("remove",function(){return n.onRemovePhotoGrade(0)}),o.qZA(),o.YNc(15,p,1,1,"app-upload-photo-grade",9),o.YNc(16,P,1,1,"app-upload-photo-grade",9),o.qZA(),o.YNc(17,U,3,0,"ion-text",10),o.qZA()(),o.TgZ(18,"ion-row")(19,"ion-col")(20,"ion-label",11),o._uU(21,"Item Fullness %"),o.qZA(),o.TgZ(22,"div",12)(23,"ion-range",13),o.NdJ("ngModelChange",function(g){return n.fullness=g}),o.TgZ(24,"ion-text",14),o._uU(25,"0"),o.qZA(),o.TgZ(26,"ion-text",15),o._uU(27,"100"),o.qZA()()()()(),o.TgZ(28,"ion-row")(29,"ion-col")(30,"ion-label",11),o._uU(31,"Notes"),o.qZA()()(),o.TgZ(32,"ion-row")(33,"ion-col")(34,"ion-textarea",16),o.NdJ("ngModelChange",function(g){return n.notes=g}),o.qZA()()()(),o.TgZ(35,"ion-button",17),o.NdJ("click",function(){return n.submitGrading()}),o.TgZ(36,"ion-text",18),o._uU(37,"Submit for grading"),o.qZA()()()),2&t&&(o.xp6(14),o.Q6J("photoDataUrl",n.photoGradeDataUrl.length?n.photoGradeDataUrl[0]:""),o.xp6(1),o.Q6J("ngIf",n.photoGradeDataUrl.length>0),o.xp6(1),o.Q6J("ngIf",n.photoGradeDataUrl.length>1),o.xp6(1),o.Q6J("ngIf",n.showError&&!n.photoGradeDataUrl.length),o.xp6(6),o.Q6J("pin",!0)("ngModel",n.fullness),o.xp6(11),o.Q6J("ngModel",n.notes))},dependencies:[_.O5,c.JJ,c.On,a.oU,a.YG,a.Sm,a.wI,a.W2,a.jY,a.Gu,a.Q$,a.I_,a.Nd,a.yW,a.g2,a.wd,a.sr,a.QI,a.j9,a.cs,r],styles:["ion-textarea[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}ion-label[_ngcontent-%COMP%]{padding-bottom:16px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}.submit-grading-button[_ngcontent-%COMP%]{--background: #000;--border-radius: 12px;height:46px;text-transform:capitalize}.add-photo-button[_ngcontent-%COMP%]{--background: #fff;width:104px;height:83px}.grade-photo[_ngcontent-%COMP%]{width:104px;height:83px;background:#000}.add-photo-icon[_ngcontent-%COMP%]{--color: #000;width:26px;height:26px}ion-title[_ngcontent-%COMP%]{text-transform:uppercase;font-size:18px}"]}),e})()}];let b=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[l.Bz.forChild(T),l.Bz]}),e})();var D=d(1075);let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[_.ez,c.u5,a.Pc,b,D.m]}),e})()},1075:(M,m,d)=>{d.d(m,{m:()=>f});var _=d(6895),c=d(4719),a=d(2478),l=d(7631);let f=(()=>{class o{}return o.\u0275fac=function(C){return new(C||o)},o.\u0275mod=l.oAB({type:o}),o.\u0275inj=l.cJS({imports:[_.ez,c.u5,a.Pc]}),o})()}}]);