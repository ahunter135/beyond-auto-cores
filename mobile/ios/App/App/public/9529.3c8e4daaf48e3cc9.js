"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9529],{9529:(Rt,O,x)=>{x.r(O),x.d(O,{UserProfilePageModule:()=>yt});var R=x(6895),_=x(4719),S=x(5861),e=x(7631),Y=x(1481);const D=["wrapper"],N=["sourceImage"];function J(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"img",4,5),e.NdJ("load",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.imageLoadedInView())})("mousedown",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.startMove(a,r.moveTypes.Drag))})("touchstart",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.startMove(a,r.moveTypes.Drag))}),e.qZA()}if(2&n){const t=e.oxw();e.Udp("visibility",t.imageVisible?"visible":"hidden")("transform",t.safeTransformStyle),e.ekj("ngx-ic-draggable",!t.disabled&&t.allowMoveImage),e.Q6J("src",t.safeImgDataUrl,e.LSH),e.uIk("alt",t.imageAltText)}}function G(n,c){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span",9),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"topleft"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"topleft"))}),e._UZ(2,"span",10),e.qZA(),e.TgZ(3,"span",11),e._UZ(4,"span",10),e.qZA(),e.TgZ(5,"span",12),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"topright"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"topright"))}),e._UZ(6,"span",10),e.qZA(),e.TgZ(7,"span",13),e._UZ(8,"span",10),e.qZA(),e.TgZ(9,"span",14),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottomright"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottomright"))}),e._UZ(10,"span",10),e.qZA(),e.TgZ(11,"span",15),e._UZ(12,"span",10),e.qZA(),e.TgZ(13,"span",16),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottomleft"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottomleft"))}),e._UZ(14,"span",10),e.qZA(),e.TgZ(15,"span",17),e._UZ(16,"span",10),e.qZA(),e.TgZ(17,"span",18),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"top"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"top"))}),e.qZA(),e.TgZ(18,"span",19),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"right"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"right"))}),e.qZA(),e.TgZ(19,"span",20),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottom"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"bottom"))}),e.qZA(),e.TgZ(20,"span",21),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"left"))})("touchstart",function(a){e.CHM(t);const r=e.oxw(2);return e.KtG(r.startMove(a,r.moveTypes.Resize,"left"))}),e.qZA(),e.BQk()}}function q(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("keydown",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.keyboardAccess(a))}),e.TgZ(1,"div",7),e.NdJ("mousedown",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.startMove(a,r.moveTypes.Move))})("touchstart",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.startMove(a,r.moveTypes.Move))}),e.qZA(),e.YNc(2,G,21,0,"ng-container",8),e.qZA()}if(2&n){const t=e.oxw();e.Udp("top",t.cropper.y1,"px")("left",t.cropper.x1,"px")("width",t.cropper.x2-t.cropper.x1,"px")("height",t.cropper.y2-t.cropper.y1,"px")("margin-left","center"===t.alignImage?t.marginLeft:null)("visibility",t.imageVisible?"visible":"hidden"),e.ekj("ngx-ic-round",t.roundCropper),e.xp6(2),e.Q6J("ngIf",!t.hideResizeSquares)}}class K{constructor(){this.format="png",this.maintainAspectRatio=!0,this.transform={},this.aspectRatio=1,this.resetCropOnAspectRatioChange=!0,this.resizeToWidth=0,this.resizeToHeight=0,this.cropperMinWidth=0,this.cropperMinHeight=0,this.cropperMaxHeight=0,this.cropperMaxWidth=0,this.cropperStaticWidth=0,this.cropperStaticHeight=0,this.canvasRotation=0,this.initialStepSize=3,this.roundCropper=!1,this.onlyScaleDown=!1,this.imageQuality=92,this.autoCrop=!0,this.backgroundColor=null,this.containWithinAspectRatio=!1,this.hideResizeSquares=!1,this.alignImage="center",this.cropperScaledMinWidth=20,this.cropperScaledMinHeight=20,this.cropperScaledMaxWidth=20,this.cropperScaledMaxHeight=20,this.stepSize=this.initialStepSize}setOptions(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t]),this.validateOptions()}setOptionsFromChanges(c){Object.keys(c).filter(t=>t in this).forEach(t=>this[t]=c[t].currentValue),this.validateOptions()}validateOptions(){if(this.maintainAspectRatio&&!this.aspectRatio)throw new Error("`aspectRatio` should > 0 when `maintainAspectRatio` is enabled")}}var d=(()=>{return(n=d||(d={})).Drag="drag",n.Move="move",n.Resize="resize",n.Pinch="pinch",d;var n})();function E(n,c){return n/100*c}let tt=(()=>{class n{crop(t,i,a,r){const o=this.getImagePosition(t,i,a,r),s=o.x2-o.x1,h=o.y2-o.y1,p=document.createElement("canvas");p.width=s,p.height=h;const g=p.getContext("2d");if(!g)return null;null!=r.backgroundColor&&(g.fillStyle=r.backgroundColor,g.fillRect(0,0,s,h));const l=(r.transform.scale||1)*(r.transform.flipH?-1:1),M=(r.transform.scale||1)*(r.transform.flipV?-1:1),{translateH:y,translateV:A}=this.getCanvasTranslate(t,i,r),u=i.transformed;g.setTransform(l,0,0,M,u.size.width/2+y,u.size.height/2+A),g.translate(-o.x1/l,-o.y1/M),g.rotate((r.transform.rotate||0)*Math.PI/180),g.drawImage(u.image,-u.size.width/2,-u.size.height/2);const f={width:s,height:h,imagePosition:o,cropperPosition:{...a}};r.containWithinAspectRatio&&(f.offsetImagePosition=this.getOffsetImagePosition(t,i,a,r));const I=this.getResizeRatio(s,h,r);return 1!==I&&(f.width=Math.round(s*I),f.height=r.maintainAspectRatio?Math.round(f.width/r.aspectRatio):Math.round(h*I),function $(n,c,t){const i=n.width,a=n.height,r=i/(c=Math.round(c)),o=a/(t=Math.round(t)),s=Math.ceil(r/2),h=Math.ceil(o/2),p=n.getContext("2d");if(p){const g=p.getImageData(0,0,i,a),l=p.createImageData(c,t),M=g.data,y=l.data;for(let A=0;A<t;A++)for(let u=0;u<c;u++){const f=4*(u+A*c),I=A*o;let C=0,b=0,k=0,B=0,Z=0,P=0,Q=0;const vt=Math.floor(u*r),wt=Math.floor(A*o);let H=Math.ceil((u+1)*r),U=Math.ceil((A+1)*o);H=Math.min(H,i),U=Math.min(U,a);for(let z=wt;z<U;z++){const F=Math.abs(I-z)/h,St=u*r,It=F*F;for(let T=vt;T<H;T++){const L=Math.abs(St-T)/s,v=Math.sqrt(It+L*L);if(v>=1)continue;C=2*v*v*v-3*v*v+1;const w=4*(T+z*i);Q+=C*M[w+3],k+=C,M[w+3]<255&&(C=C*M[w+3]/250),B+=C*M[w],Z+=C*M[w+1],P+=C*M[w+2],b+=C}}y[f]=B/b,y[f+1]=Z/b,y[f+2]=P/b,y[f+3]=Q/k}n.width=c,n.height=t,p.putImageData(l,0,0)}}(p,f.width,f.height)),f.base64=p.toDataURL("image/"+r.format,this.getQuality(r)),f}getCanvasTranslate(t,i,a){if("px"===a.transform.translateUnit){const r=this.getRatio(t,i);return{translateH:(a.transform.translateH||0)*r,translateV:(a.transform.translateV||0)*r}}return{translateH:a.transform.translateH?E(a.transform.translateH,i.transformed.size.width):0,translateV:a.transform.translateV?E(a.transform.translateV,i.transformed.size.height):0}}getRatio(t,i){return i.transformed.size.width/t.nativeElement.offsetWidth}getImagePosition(t,i,a,r){const o=this.getRatio(t,i),s={x1:Math.round(a.x1*o),y1:Math.round(a.y1*o),x2:Math.round(a.x2*o),y2:Math.round(a.y2*o)};return r.containWithinAspectRatio||(s.x1=Math.max(s.x1,0),s.y1=Math.max(s.y1,0),s.x2=Math.min(s.x2,i.transformed.size.width),s.y2=Math.min(s.y2,i.transformed.size.height)),s}getOffsetImagePosition(t,i,a,r){const h=i.transformed.size.width/t.nativeElement.offsetWidth;let p,g;(r.canvasRotation+i.exifTransform.rotate)%2?(p=(i.transformed.size.width-i.original.size.height)/2,g=(i.transformed.size.height-i.original.size.width)/2):(p=(i.transformed.size.width-i.original.size.width)/2,g=(i.transformed.size.height-i.original.size.height)/2);const l={x1:Math.round(a.x1*h)-p,y1:Math.round(a.y1*h)-g,x2:Math.round(a.x2*h)-p,y2:Math.round(a.y2*h)-g};return r.containWithinAspectRatio||(l.x1=Math.max(l.x1,0),l.y1=Math.max(l.y1,0),l.x2=Math.min(l.x2,i.transformed.size.width),l.y2=Math.min(l.y2,i.transformed.size.height)),l}getResizeRatio(t,i,a){const r=a.resizeToWidth/t,o=a.resizeToHeight/i,s=new Array;a.resizeToWidth>0&&s.push(r),a.resizeToHeight>0&&s.push(o);const h=0===s.length?1:Math.min(...s);return h>1&&!a.onlyScaleDown?h:Math.min(h,1)}getQuality(t){return Math.min(1,Math.max(0,t.imageQuality/100))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),et=(()=>{class n{resetCropperPosition(t,i,a){if(!t?.nativeElement)return;const r=t.nativeElement;if(a.cropperStaticHeight&&a.cropperStaticWidth)i.x1=0,i.x2=r.offsetWidth>a.cropperStaticWidth?a.cropperStaticWidth:r.offsetWidth,i.y1=0,i.y2=r.offsetHeight>a.cropperStaticHeight?a.cropperStaticHeight:r.offsetHeight;else{const o=Math.min(a.cropperScaledMaxWidth,r.offsetWidth),s=Math.min(a.cropperScaledMaxHeight,r.offsetHeight);if(a.maintainAspectRatio)if(r.offsetWidth/a.aspectRatio<r.offsetHeight){i.x1=0,i.x2=o;const h=o/a.aspectRatio;i.y1=(r.offsetHeight-h)/2,i.y2=i.y1+h}else{i.y1=0,i.y2=s;const h=s*a.aspectRatio;i.x1=(r.offsetWidth-h)/2,i.x2=i.x1+h}else i.x1=0,i.x2=o,i.y1=0,i.y2=s}}move(t,i,a){const r=this.getClientX(t)-i.clientX,o=this.getClientY(t)-i.clientY;a.x1=i.x1+r,a.y1=i.y1+o,a.x2=i.x2+r,a.y2=i.y2+o}resize(t,i,a,r,o){const s=this.getClientX(t)-i.clientX,h=this.getClientY(t)-i.clientY;switch(i.position){case"left":a.x1=Math.min(Math.max(i.x1+s,a.x2-o.cropperScaledMaxWidth),a.x2-o.cropperScaledMinWidth);break;case"topleft":a.x1=Math.min(Math.max(i.x1+s,a.x2-o.cropperScaledMaxWidth),a.x2-o.cropperScaledMinWidth),a.y1=Math.min(Math.max(i.y1+h,a.y2-o.cropperScaledMaxHeight),a.y2-o.cropperScaledMinHeight);break;case"top":a.y1=Math.min(Math.max(i.y1+h,a.y2-o.cropperScaledMaxHeight),a.y2-o.cropperScaledMinHeight);break;case"topright":a.x2=Math.max(Math.min(i.x2+s,a.x1+o.cropperScaledMaxWidth),a.x1+o.cropperScaledMinWidth),a.y1=Math.min(Math.max(i.y1+h,a.y2-o.cropperScaledMaxHeight),a.y2-o.cropperScaledMinHeight);break;case"right":a.x2=Math.max(Math.min(i.x2+s,a.x1+o.cropperScaledMaxWidth),a.x1+o.cropperScaledMinWidth);break;case"bottomright":a.x2=Math.max(Math.min(i.x2+s,a.x1+o.cropperScaledMaxWidth),a.x1+o.cropperScaledMinWidth),a.y2=Math.max(Math.min(i.y2+h,a.y1+o.cropperScaledMaxHeight),a.y1+o.cropperScaledMinHeight);break;case"bottom":a.y2=Math.max(Math.min(i.y2+h,a.y1+o.cropperScaledMaxHeight),a.y1+o.cropperScaledMinHeight);break;case"bottomleft":a.x1=Math.min(Math.max(i.x1+s,a.x2-o.cropperScaledMaxWidth),a.x2-o.cropperScaledMinWidth),a.y2=Math.max(Math.min(i.y2+h,a.y1+o.cropperScaledMaxHeight),a.y1+o.cropperScaledMinHeight);break;case"center":const p=t.scale,g=Math.min(Math.max(o.cropperScaledMinWidth,Math.abs(i.x2-i.x1)*p),o.cropperScaledMaxWidth),l=Math.min(Math.max(o.cropperScaledMinHeight,Math.abs(i.y2-i.y1)*p),o.cropperScaledMaxHeight);a.x1=i.clientX-g/2,a.x2=i.clientX+g/2,a.y1=i.clientY-l/2,a.y2=i.clientY+l/2,a.x1<0?(a.x2-=a.x1,a.x1=0):a.x2>r.width&&(a.x1-=a.x2-r.width,a.x2=r.width),a.y1<0?(a.y2-=a.y1,a.y1=0):a.y2>r.height&&(a.y1-=a.y2-r.height,a.y2=r.height)}o.maintainAspectRatio&&this.checkAspectRatio(i.position,a,r,o)}checkAspectRatio(t,i,a,r){let o=0,s=0;switch(t){case"top":i.x2=i.x1+(i.y2-i.y1)*r.aspectRatio,o=Math.max(i.x2-a.width,0),s=Math.max(0-i.y1,0),(o>0||s>0)&&(i.x2-=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y1+=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"bottom":i.x2=i.x1+(i.y2-i.y1)*r.aspectRatio,o=Math.max(i.x2-a.width,0),s=Math.max(i.y2-a.height,0),(o>0||s>0)&&(i.x2-=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y2-=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"topleft":i.y1=i.y2-(i.x2-i.x1)/r.aspectRatio,o=Math.max(0-i.x1,0),s=Math.max(0-i.y1,0),(o>0||s>0)&&(i.x1+=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y1+=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"topright":i.y1=i.y2-(i.x2-i.x1)/r.aspectRatio,o=Math.max(i.x2-a.width,0),s=Math.max(0-i.y1,0),(o>0||s>0)&&(i.x2-=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y1+=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"right":case"bottomright":i.y2=i.y1+(i.x2-i.x1)/r.aspectRatio,o=Math.max(i.x2-a.width,0),s=Math.max(i.y2-a.height,0),(o>0||s>0)&&(i.x2-=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y2-=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"left":case"bottomleft":i.y2=i.y1+(i.x2-i.x1)/r.aspectRatio,o=Math.max(0-i.x1,0),s=Math.max(i.y2-a.height,0),(o>0||s>0)&&(i.x1+=s*r.aspectRatio>o?s*r.aspectRatio:o,i.y2-=s*r.aspectRatio>o?s:o/r.aspectRatio);break;case"center":i.x2=i.x1+(i.y2-i.y1)*r.aspectRatio,i.y2=i.y1+(i.x2-i.x1)/r.aspectRatio;const h=Math.max(0-i.x1,0),p=Math.max(i.x2-a.width,0),g=Math.max(i.y2-a.height,0),l=Math.max(0-i.y1,0);(h>0||p>0||g>0||l>0)&&(i.x1+=g*r.aspectRatio>h?g*r.aspectRatio:h,i.x2-=l*r.aspectRatio>p?l*r.aspectRatio:p,i.y1+=l*r.aspectRatio>p?l:p/r.aspectRatio,i.y2-=g*r.aspectRatio>h?g:h/r.aspectRatio)}}getClientX(t){return t.touches?.[0].clientX||t.clientX||0}getClientY(t){return t.touches?.[0].clientY||t.clientY||0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();let st=(()=>{class n{constructor(){this.autoRotateSupported=function at(){return new Promise(n=>{const c=new Image;c.onload=()=>{n(1===c.width&&2===c.height)},c.src="data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=="})}()}loadImageFile(t,i){return new Promise((a,r)=>{const o=new FileReader;o.onload=s=>{this.loadImage(s.target.result,t.type,i).then(a).catch(r)},o.readAsDataURL(t)})}loadImage(t,i,a){return this.isValidImageType(i)?this.loadBase64Image(t,a):Promise.reject(new Error("Invalid image type"))}isValidImageType(t){return/image\/(png|jpg|jpeg|bmp|gif|tiff|webp|x-icon|vnd.microsoft.icon)/.test(t)}loadImageFromURL(t,i){return new Promise((a,r)=>{const o=new Image;o.onerror=()=>r,o.onload=()=>{const s=document.createElement("canvas"),h=s.getContext("2d");s.width=o.width,s.height=o.height,h?.drawImage(o,0,0),this.loadBase64Image(s.toDataURL(),i).then(a)},o.crossOrigin="anonymous",o.src=t})}loadBase64Image(t,i){return new Promise((a,r)=>{const o=new Image;o.onload=()=>a({originalImage:o,originalBase64:t}),o.onerror=r,o.src=t}).then(a=>this.transformImageBase64(a,i))}transformImageBase64(t,i){var a=this;return(0,S.Z)(function*(){const r=yield a.autoRotateSupported,o=yield function rt(n){switch("string"==typeof n&&(n=function ot(n){const c=new DataView(function nt(n){n=n.replace(/^data\:([^\;]+)\;base64,/gim,"");const c=atob(n),t=c.length,i=new Uint8Array(t);for(let a=0;a<t;a++)i[a]=c.charCodeAt(a);return i.buffer}(n));if(65496!==c.getUint16(0,!1))return-2;const t=c.byteLength;let i=2;for(;i<t;){if(c.getUint16(i+2,!1)<=8)return-1;const a=c.getUint16(i,!1);if(i+=2,65505==a){if(1165519206!==c.getUint32(i+=2,!1))return-1;const r=18761==c.getUint16(i+=6,!1);i+=c.getUint32(i+4,r);const o=c.getUint16(i,r);i+=2;for(let s=0;s<o;s++)if(274==c.getUint16(i+12*s,r))return c.getUint16(i+12*s+8,r)}else{if(65280!=(65280&a))break;i+=c.getUint16(i,!1)}}return-1}(n)),n){case 2:return{rotate:0,flip:!0};case 3:return{rotate:2,flip:!1};case 4:return{rotate:2,flip:!0};case 5:return{rotate:1,flip:!0};case 6:return{rotate:1,flip:!1};case 7:return{rotate:3,flip:!0};case 8:return{rotate:3,flip:!1};default:return{rotate:0,flip:!1}}}(r?-1:t.originalBase64);return t.originalImage&&t.originalImage.complete?a.transformLoadedImage({original:{base64:t.originalBase64,image:t.originalImage,size:{width:t.originalImage.naturalWidth,height:t.originalImage.naturalHeight}},exifTransform:o},i):Promise.reject(new Error("No image loaded"))})()}transformLoadedImage(t,i){var a=this;return(0,S.Z)(function*(){const r=i.canvasRotation+t.exifTransform.rotate,o={width:t.original.image.naturalWidth,height:t.original.image.naturalHeight};if(0===r&&!t.exifTransform.flip&&!i.containWithinAspectRatio)return{original:{base64:t.original.base64,image:t.original.image,size:{...o}},transformed:{base64:t.original.base64,image:t.original.image,size:{...o}},exifTransform:t.exifTransform};const s=a.getTransformedSize(o,t.exifTransform,i),h=document.createElement("canvas");h.width=s.width,h.height=s.height;const p=h.getContext("2d");p?.setTransform(t.exifTransform.flip?-1:1,0,0,1,h.width/2,h.height/2),p?.rotate(Math.PI*(r/2)),p?.drawImage(t.original.image,-o.width/2,-o.height/2);const g=h.toDataURL(),l=yield a.loadImageFromBase64(g);return{original:{base64:t.original.base64,image:t.original.image,size:{...o}},transformed:{base64:g,image:l,size:{width:l.width,height:l.height}},exifTransform:t.exifTransform}})()}loadImageFromBase64(t){return new Promise((i,a)=>{const r=new Image;r.onload=()=>i(r),r.onerror=a,r.src=t})}getTransformedSize(t,i,a){const r=a.canvasRotation+i.rotate;if(a.containWithinAspectRatio){if(r%2){const s=t.height/a.aspectRatio;return{width:Math.max(t.height,t.width*a.aspectRatio),height:Math.max(t.width,s)}}{const s=t.width/a.aspectRatio;return{width:Math.max(t.width,t.height*a.aspectRatio),height:Math.max(t.height,s)}}}return r%2?{height:t.width,width:t.height}:{width:t.width,height:t.height}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ct=(()=>{class n{constructor(t,i,a,r,o){this.cropService=t,this.cropperPositionService=i,this.loadImageService=a,this.sanitizer=r,this.cd=o,this.Hammer=window?.Hammer||null,this.settings=new K,this.setImageMaxSizeRetries=0,this.resizedWhileHidden=!1,this.marginLeft="0px",this.maxSize={width:0,height:0},this.moveTypes=d,this.imageVisible=!1,this.format=this.settings.format,this.transform={},this.maintainAspectRatio=this.settings.maintainAspectRatio,this.aspectRatio=this.settings.aspectRatio,this.resetCropOnAspectRatioChange=this.settings.resetCropOnAspectRatioChange,this.resizeToWidth=this.settings.resizeToWidth,this.resizeToHeight=this.settings.resizeToHeight,this.cropperMinWidth=this.settings.cropperMinWidth,this.cropperMinHeight=this.settings.cropperMinHeight,this.cropperMaxHeight=this.settings.cropperMaxHeight,this.cropperMaxWidth=this.settings.cropperMaxWidth,this.cropperStaticWidth=this.settings.cropperStaticWidth,this.cropperStaticHeight=this.settings.cropperStaticHeight,this.canvasRotation=this.settings.canvasRotation,this.initialStepSize=this.settings.initialStepSize,this.roundCropper=this.settings.roundCropper,this.onlyScaleDown=this.settings.onlyScaleDown,this.imageQuality=this.settings.imageQuality,this.autoCrop=this.settings.autoCrop,this.backgroundColor=this.settings.backgroundColor,this.containWithinAspectRatio=this.settings.containWithinAspectRatio,this.hideResizeSquares=this.settings.hideResizeSquares,this.allowMoveImage=!1,this.cropper={x1:-100,y1:-100,x2:1e4,y2:1e4},this.alignImage=this.settings.alignImage,this.disabled=!1,this.hidden=!1,this.imageCropped=new e.vpe,this.startCropImage=new e.vpe,this.imageLoaded=new e.vpe,this.cropperReady=new e.vpe,this.loadImageFailed=new e.vpe,this.transformChange=new e.vpe,this.reset()}ngOnChanges(t){this.onChangesUpdateSettings(t),this.onChangesInputImage(t),this.loadedImage?.original.image.complete&&(t.containWithinAspectRatio||t.canvasRotation)&&this.loadImageService.transformLoadedImage(this.loadedImage,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i)),(t.cropper||t.maintainAspectRatio||t.aspectRatio)&&(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),!this.maintainAspectRatio||!this.resetCropOnAspectRatioChange&&this.aspectRatioIsCorrect()||!t.maintainAspectRatio&&!t.aspectRatio?t.cropper&&(this.checkCropperPosition(!1),this.doAutoCrop()):this.resetCropperPosition(),this.cd.markForCheck()),t.transform&&(this.transform=this.transform||{},this.setCssTransform(),this.doAutoCrop(),this.cd.markForCheck()),t.hidden&&this.resizedWhileHidden&&!this.hidden&&setTimeout(()=>{this.onResize(),this.resizedWhileHidden=!1})}onChangesUpdateSettings(t){this.settings.setOptionsFromChanges(t),this.settings.cropperStaticHeight&&this.settings.cropperStaticWidth&&this.settings.setOptions({hideResizeSquares:!0,cropperMinWidth:this.settings.cropperStaticWidth,cropperMinHeight:this.settings.cropperStaticHeight,cropperMaxHeight:this.settings.cropperStaticHeight,cropperMaxWidth:this.settings.cropperStaticWidth,maintainAspectRatio:!1})}onChangesInputImage(t){(t.imageChangedEvent||t.imageURL||t.imageBase64||t.imageFile)&&this.reset(),t.imageChangedEvent&&this.isValidImageChangedEvent()&&this.loadImageFile(this.imageChangedEvent.target.files[0]),t.imageURL&&this.imageURL&&this.loadImageFromURL(this.imageURL),t.imageBase64&&this.imageBase64&&this.loadBase64Image(this.imageBase64),t.imageFile&&this.imageFile&&this.loadImageFile(this.imageFile)}isValidImageChangedEvent(){return this.imageChangedEvent?.target?.files?.length>0}setCssTransform(){const t=this.transform?.translateUnit||"%";this.safeTransformStyle=this.sanitizer.bypassSecurityTrustStyle(`translate(${this.transform.translateH||0}${t}, ${this.transform.translateV||0}${t}) scaleX(`+(this.transform.scale||1)*(this.transform.flipH?-1:1)+") scaleY("+(this.transform.scale||1)*(this.transform.flipV?-1:1)+") rotate("+(this.transform.rotate||0)+"deg)")}ngOnInit(){this.settings.stepSize=this.initialStepSize,this.activatePinchGesture()}reset(){this.imageVisible=!1,this.loadedImage=void 0,this.safeImgDataUrl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=",this.moveStart={active:!1,type:null,position:null,x1:0,y1:0,x2:0,y2:0,clientX:0,clientY:0},this.maxSize={width:0,height:0},this.cropper.x1=-100,this.cropper.y1=-100,this.cropper.x2=1e4,this.cropper.y2=1e4}loadImageFile(t){this.loadImageService.loadImageFile(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadBase64Image(t){this.loadImageService.loadBase64Image(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}loadImageFromURL(t){this.loadImageService.loadImageFromURL(t,this.settings).then(i=>this.setLoadedImage(i)).catch(i=>this.loadImageError(i))}setLoadedImage(t){this.loadedImage=t,this.safeImgDataUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t.transformed.base64),this.cd.markForCheck()}loadImageError(t){console.error(t),this.loadImageFailed.emit()}imageLoadedInView(){null!=this.loadedImage&&(this.imageLoaded.emit(this.loadedImage),this.setImageMaxSizeRetries=0,setTimeout(()=>this.checkImageMaxSizeRecursively()))}checkImageMaxSizeRecursively(){this.setImageMaxSizeRetries>40?this.loadImageFailed.emit():this.sourceImageLoaded()?(this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize(),this.resetCropperPosition(),this.cropperReady.emit({...this.maxSize}),this.cd.markForCheck()):(this.setImageMaxSizeRetries++,setTimeout(()=>this.checkImageMaxSizeRecursively(),50))}sourceImageLoaded(){return this.sourceImage?.nativeElement?.offsetWidth>0}onResize(){!this.loadedImage||(this.hidden?this.resizedWhileHidden=!0:(this.resizeCropperPosition(),this.setMaxSize(),this.setCropperScaledMinSize(),this.setCropperScaledMaxSize()))}activatePinchGesture(){if(this.Hammer){const t=new this.Hammer(this.wrapper.nativeElement);t.get("pinch").set({enable:!0}),t.on("pinchmove",this.onPinch.bind(this)),t.on("pinchend",this.pinchStop.bind(this)),t.on("pinchstart",this.startPinch.bind(this))}else(0,e.X6Q)()&&console.warn("[NgxImageCropper] Could not find HammerJS - Pinch Gesture won't work")}resizeCropperPosition(){const t=this.sourceImage.nativeElement;(this.maxSize.width!==t.offsetWidth||this.maxSize.height!==t.offsetHeight)&&(this.cropper.x1=this.cropper.x1*t.offsetWidth/this.maxSize.width,this.cropper.x2=this.cropper.x2*t.offsetWidth/this.maxSize.width,this.cropper.y1=this.cropper.y1*t.offsetHeight/this.maxSize.height,this.cropper.y2=this.cropper.y2*t.offsetHeight/this.maxSize.height)}resetCropperPosition(){this.cropperPositionService.resetCropperPosition(this.sourceImage,this.cropper,this.settings),this.doAutoCrop(),this.imageVisible=!0}keyboardAccess(t){this.changeKeyboardStepSize(t),this.keyboardMoveCropper(t)}changeKeyboardStepSize(t){const i=+t.key;i>=1&&i<=9&&(this.settings.stepSize=i)}keyboardMoveCropper(t){if(!["ArrowUp","ArrowDown","ArrowRight","ArrowLeft"].includes(t.key))return;const a=t.shiftKey?d.Resize:d.Move,r=t.altKey?function V(n){switch(n){case"ArrowUp":return"bottom";case"ArrowRight":return"left";case"ArrowDown":return"top";default:return"right"}}(t.key):function X(n){switch(n){case"ArrowUp":return"top";case"ArrowRight":return"right";case"ArrowDown":return"bottom";default:return"left"}}(t.key),o=function j(n,c){switch(n){case"ArrowUp":return{clientX:0,clientY:-1*c};case"ArrowRight":return{clientX:c,clientY:0};case"ArrowDown":return{clientX:0,clientY:c};default:return{clientX:-1*c,clientY:0}}}(t.key,this.settings.stepSize);t.preventDefault(),t.stopPropagation(),this.startMove({clientX:0,clientY:0},a,r),this.moveImg(o),this.moveStop()}startMove(t,i,a=null){this.disabled||this.moveStart?.active&&this.moveStart?.type===d.Pinch||i===d.Drag&&!this.allowMoveImage||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:i,position:a,transform:{...this.transform},clientX:this.cropperPositionService.getClientX(t),clientY:this.cropperPositionService.getClientY(t),...this.cropper})}startPinch(t){!this.safeImgDataUrl||(t.preventDefault&&t.preventDefault(),this.moveStart={active:!0,type:d.Pinch,position:"center",clientX:this.cropper.x1+(this.cropper.x2-this.cropper.x1)/2,clientY:this.cropper.y1+(this.cropper.y2-this.cropper.y1)/2,...this.cropper})}moveImg(t){if(this.moveStart.active){if(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===d.Move)this.cropperPositionService.move(t,this.moveStart,this.cropper),this.checkCropperPosition(!0);else if(this.moveStart.type===d.Resize)!this.cropperStaticWidth&&!this.cropperStaticHeight&&this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1);else if(this.moveStart.type===d.Drag){const i=this.cropperPositionService.getClientX(t)-this.moveStart.clientX,a=this.cropperPositionService.getClientY(t)-this.moveStart.clientY;this.transform={...this.transform,translateH:(this.moveStart.transform?.translateH||0)+i,translateV:(this.moveStart.transform?.translateV||0)+a},this.setCssTransform()}this.cd.detectChanges()}}onPinch(t){this.moveStart.active&&(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),this.moveStart.type===d.Pinch&&(this.cropperPositionService.resize(t,this.moveStart,this.cropper,this.maxSize,this.settings),this.checkCropperPosition(!1)),this.cd.detectChanges())}setMaxSize(){if(this.sourceImage){const t=this.sourceImage.nativeElement;this.maxSize.width=t.offsetWidth,this.maxSize.height=t.offsetHeight,this.marginLeft=this.sanitizer.bypassSecurityTrustStyle("calc(50% - "+this.maxSize.width/2+"px)")}}setCropperScaledMinSize(){this.loadedImage?.transformed?.image?(this.setCropperScaledMinWidth(),this.setCropperScaledMinHeight()):(this.settings.cropperScaledMinWidth=20,this.settings.cropperScaledMinHeight=20)}setCropperScaledMinWidth(){this.settings.cropperScaledMinWidth=this.cropperMinWidth>0?Math.max(20,this.cropperMinWidth/this.loadedImage.transformed.image.width*this.maxSize.width):20}setCropperScaledMinHeight(){this.settings.cropperScaledMinHeight=this.maintainAspectRatio?Math.max(20,this.settings.cropperScaledMinWidth/this.aspectRatio):this.cropperMinHeight>0?Math.max(20,this.cropperMinHeight/this.loadedImage.transformed.image.height*this.maxSize.height):20}setCropperScaledMaxSize(){if(this.loadedImage?.transformed?.image){const t=this.loadedImage.transformed.size.width/this.maxSize.width;this.settings.cropperScaledMaxWidth=this.cropperMaxWidth>20?this.cropperMaxWidth/t:this.maxSize.width,this.settings.cropperScaledMaxHeight=this.cropperMaxHeight>20?this.cropperMaxHeight/t:this.maxSize.height,this.maintainAspectRatio&&(this.settings.cropperScaledMaxWidth>this.settings.cropperScaledMaxHeight*this.aspectRatio?this.settings.cropperScaledMaxWidth=this.settings.cropperScaledMaxHeight*this.aspectRatio:this.settings.cropperScaledMaxWidth<this.settings.cropperScaledMaxHeight*this.aspectRatio&&(this.settings.cropperScaledMaxHeight=this.settings.cropperScaledMaxWidth/this.aspectRatio))}else this.settings.cropperScaledMaxWidth=this.maxSize.width,this.settings.cropperScaledMaxHeight=this.maxSize.height}checkCropperPosition(t=!1){this.cropper.x1<0&&(this.cropper.x2-=t?this.cropper.x1:0,this.cropper.x1=0),this.cropper.y1<0&&(this.cropper.y2-=t?this.cropper.y1:0,this.cropper.y1=0),this.cropper.x2>this.maxSize.width&&(this.cropper.x1-=t?this.cropper.x2-this.maxSize.width:0,this.cropper.x2=this.maxSize.width),this.cropper.y2>this.maxSize.height&&(this.cropper.y1-=t?this.cropper.y2-this.maxSize.height:0,this.cropper.y2=this.maxSize.height)}moveStop(){this.moveStart.active&&(this.moveStart.active=!1,this.moveStart?.type===d.Drag?this.transformChange.emit(this.transform):this.doAutoCrop())}pinchStop(){this.moveStart.active&&(this.moveStart.active=!1,this.doAutoCrop())}doAutoCrop(){this.autoCrop&&this.crop()}crop(){if(null!=this.loadedImage?.transformed?.image){this.startCropImage.emit();const t=this.cropService.crop(this.sourceImage,this.loadedImage,this.cropper,this.settings);return null!=t&&this.imageCropped.emit(t),t}return null}aspectRatioIsCorrect(){return(this.cropper.x2-this.cropper.x1)/(this.cropper.y2-this.cropper.y1)===this.aspectRatio}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(tt),e.Y36(et),e.Y36(st),e.Y36(Y.H7),e.Y36(e.sBO))},n.\u0275cmp=e.Xpm({type:n,selectors:[["image-cropper"]],viewQuery:function(t,i){if(1&t&&(e.Gf(D,7),e.Gf(N,5)),2&t){let a;e.iGM(a=e.CRH())&&(i.wrapper=a.first),e.iGM(a=e.CRH())&&(i.sourceImage=a.first)}},hostVars:6,hostBindings:function(t,i){1&t&&e.NdJ("resize",function(){return i.onResize()},!1,e.Jf7)("mousemove",function(r){return i.moveImg(r)},!1,e.evT)("touchmove",function(r){return i.moveImg(r)},!1,e.evT)("mouseup",function(){return i.moveStop()},!1,e.evT)("touchend",function(){return i.moveStop()},!1,e.evT),2&t&&(e.Udp("text-align",i.alignImage),e.ekj("disabled",i.disabled)("ngx-ix-hidden",i.hidden))},inputs:{imageChangedEvent:"imageChangedEvent",imageURL:"imageURL",imageBase64:"imageBase64",imageFile:"imageFile",imageAltText:"imageAltText",format:"format",transform:"transform",maintainAspectRatio:"maintainAspectRatio",aspectRatio:"aspectRatio",resetCropOnAspectRatioChange:"resetCropOnAspectRatioChange",resizeToWidth:"resizeToWidth",resizeToHeight:"resizeToHeight",cropperMinWidth:"cropperMinWidth",cropperMinHeight:"cropperMinHeight",cropperMaxHeight:"cropperMaxHeight",cropperMaxWidth:"cropperMaxWidth",cropperStaticWidth:"cropperStaticWidth",cropperStaticHeight:"cropperStaticHeight",canvasRotation:"canvasRotation",initialStepSize:"initialStepSize",roundCropper:"roundCropper",onlyScaleDown:"onlyScaleDown",imageQuality:"imageQuality",autoCrop:"autoCrop",backgroundColor:"backgroundColor",containWithinAspectRatio:"containWithinAspectRatio",hideResizeSquares:"hideResizeSquares",allowMoveImage:"allowMoveImage",cropper:"cropper",alignImage:"alignImage",disabled:"disabled",hidden:"hidden"},outputs:{imageCropped:"imageCropped",startCropImage:"startCropImage",imageLoaded:"imageLoaded",cropperReady:"cropperReady",loadImageFailed:"loadImageFailed",transformChange:"transformChange"},features:[e.TTD],decls:5,vars:10,consts:[["wrapper",""],["class","ngx-ic-source-image",3,"src","visibility","transform","ngx-ic-draggable","load","mousedown","touchstart",4,"ngIf"],[1,"ngx-ic-overlay"],["class","ngx-ic-cropper","tabindex","0",3,"ngx-ic-round","top","left","width","height","margin-left","visibility","keydown",4,"ngIf"],[1,"ngx-ic-source-image",3,"src","load","mousedown","touchstart"],["sourceImage",""],["tabindex","0",1,"ngx-ic-cropper",3,"keydown"],[1,"ngx-ic-move",3,"mousedown","touchstart"],[4,"ngIf"],[1,"ngx-ic-resize","ngx-ic-topleft",3,"mousedown","touchstart"],[1,"ngx-ic-square"],[1,"ngx-ic-resize","ngx-ic-top"],[1,"ngx-ic-resize","ngx-ic-topright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-right"],[1,"ngx-ic-resize","ngx-ic-bottomright",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-bottom"],[1,"ngx-ic-resize","ngx-ic-bottomleft",3,"mousedown","touchstart"],[1,"ngx-ic-resize","ngx-ic-left"],[1,"ngx-ic-resize-bar","ngx-ic-top",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-right",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-bottom",3,"mousedown","touchstart"],[1,"ngx-ic-resize-bar","ngx-ic-left",3,"mousedown","touchstart"]],template:function(t,i){1&t&&(e.TgZ(0,"div",null,0),e.YNc(2,J,2,8,"img",1),e._UZ(3,"div",2),e.YNc(4,q,3,15,"div",3),e.qZA()),2&t&&(e.Udp("background",i.imageVisible&&i.backgroundColor),e.xp6(2),e.Q6J("ngIf",i.safeImgDataUrl),e.xp6(1),e.Udp("width",i.maxSize.width,"px")("height",i.maxSize.height,"px")("margin-left","center"===i.alignImage?i.marginLeft:null),e.xp6(1),e.Q6J("ngIf",i.imageVisible))},dependencies:[R.O5],styles:['[_nghost-%COMP%]{display:flex;position:relative;width:100%;max-width:100%;max-height:100%;overflow:hidden;padding:5px;text-align:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]{width:100%;position:relative}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image[_ngcontent-%COMP%]{max-width:100%;max-height:100%;transform-origin:center}[_nghost-%COMP%] > div[_ngcontent-%COMP%]   img.ngx-ic-source-image.ngx-ic-draggable[_ngcontent-%COMP%]{user-drag:none;-webkit-user-drag:none;user-select:none;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;cursor:grab}[_nghost-%COMP%]   .ngx-ic-overlay[_ngcontent-%COMP%]{position:absolute;pointer-events:none;touch-action:none;outline:var(--cropper-overlay-color, white) solid 100vw;top:0;left:0}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{position:absolute;display:flex;color:#53535c;background:transparent;outline:rgba(255,255,255,.3) solid 100vw;outline:var(--cropper-outline-color, rgba(255, 255, 255, .3)) solid 100vw;touch-action:none}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]{outline-width:100vh}}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:after{position:absolute;content:"";inset:0;pointer-events:none;border:dashed 1px;opacity:.75;color:inherit;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{width:100%;cursor:move;border:1px solid rgba(255,255,255,.5)}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]:focus   .ngx-ic-move[_ngcontent-%COMP%]{border-color:#1e90ff;border-width:2px}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]{position:absolute;display:inline-block;line-height:6px;padding:8px;opacity:.85;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%]   .ngx-ic-square[_ngcontent-%COMP%]{display:inline-block;background:#53535C;width:6px;height:6px;border:1px solid rgba(255,255,255,.5);box-sizing:content-box}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topleft[_ngcontent-%COMP%]{top:-12px;left:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-top[_ngcontent-%COMP%]{top:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-topright[_ngcontent-%COMP%]{top:-12px;right:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-right[_ngcontent-%COMP%]{top:calc(50% - 12px);right:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomright[_ngcontent-%COMP%]{bottom:-12px;right:-12px;cursor:nwse-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-12px;left:calc(50% - 12px);cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-bottomleft[_ngcontent-%COMP%]{bottom:-12px;left:-12px;cursor:nesw-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize.ngx-ic-left[_ngcontent-%COMP%]{top:calc(50% - 12px);left:-12px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%]{position:absolute;z-index:1}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-top[_ngcontent-%COMP%]{top:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-right[_ngcontent-%COMP%]{top:11px;right:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-bottom[_ngcontent-%COMP%]{bottom:-11px;left:11px;width:calc(100% - 22px);height:22px;cursor:ns-resize}[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar.ngx-ic-left[_ngcontent-%COMP%]{top:11px;left:-11px;height:calc(100% - 22px);width:22px;cursor:ew-resize}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]{outline-color:transparent}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{border-radius:100%;box-shadow:0 0 0 100vw #ffffff4d;box-shadow:0 0 0 100vw var(--cropper-outline-color, rgba(255, 255, 255, .3))}@media (orientation: portrait){[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]:after{box-shadow:0 0 0 100vh #ffffff4d;box-shadow:0 0 0 100vh var(--cropper-outline-color, rgba(255, 255, 255, .3))}}[_nghost-%COMP%]   .ngx-ic-cropper.ngx-ic-round[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{border-radius:100%}.disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-resize-bar[_ngcontent-%COMP%], .disabled[_nghost-%COMP%]   .ngx-ic-cropper[_ngcontent-%COMP%]   .ngx-ic-move[_ngcontent-%COMP%]{display:none}.ngx-ix-hidden[_nghost-%COMP%]{display:none}'],changeDetection:0}),n})(),ht=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[R.ez]]}),n})();var m=x(2478),W=x(1065),pt=x(5904),gt=x(3710);const lt=["cropper"];function mt(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"ion-buttons",15)(1,"ion-button",16),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.cropImage())}),e._UZ(2,"ion-icon",17),e.qZA()()}}function dt(n,c){if(1&n&&e._UZ(0,"img",20),2&n){const t=e.oxw(2);e.Q6J("src",t.userProfileImage,e.LSH)}}function ft(n,c){if(1&n&&e._UZ(0,"img",20),2&n){const t=e.oxw(2);e.Q6J("src",t.croppedImage,e.LSH)}}function ut(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"div",18),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.uploadPhoto())}),e.TgZ(1,"ion-avatar"),e.YNc(2,dt,1,1,"img",19),e.YNc(3,ft,1,1,"img",19),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngIf",!t.croppedImage),e.xp6(1),e.Q6J("ngIf",t.croppedImage)}}function xt(n,c){if(1&n){const t=e.EpF();e.TgZ(0,"image-cropper",21,22),e.NdJ("imageLoaded",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.imageLoaded())})("loadImageFailed",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.loadImageFailed())}),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("imageBase64",t.myImage)("maintainAspectRatio",!0)("aspectRatio",1)}}function _t(n,c){1&n&&(e.TgZ(0,"small"),e._uU(1," Please enter first name. "),e.qZA())}function Mt(n,c){1&n&&(e.TgZ(0,"small"),e._uU(1," Please enter last name. "),e.qZA())}const Ct=[{path:"",component:(()=>{class n{constructor(t,i,a,r,o,s){this.formBuilder=t,this.accountService=i,this.photoService=a,this.loadingCtrl=r,this.toastCtrl=o,this.alertController=s,this.myImage="",this.croppedImage="",this.userSubscriptionName="",this.userProfileImage=this.accountService.currentUser.fileUrl||"https://media.istockphoto.com/vectors/avatar-5-vector-id1131164548?k=20&m=1131164548&s=170667a&w=0&h=VlwTJ3LpA8Pjzk9u8XYgkII0Vrvrb07e67cHALFX_aY=",this.userEmail=this.accountService.currentUser.email,this.userSubscriptionName=this.accountService.currentUser.subscriptionName}ngOnInit(){this.userProfileForm=this.formBuilder.group({firstName:[this.accountService.currentUser.firstName,[_.kI.required]],lastName:[this.accountService.currentUser.lastName,[_.kI.required]]})}save(){var t=this;return(0,S.Z)(function*(){if(t.userProfileForm.valid){const i=t.accountService.currentUser,{firstName:a,lastName:r}=t.userProfileForm.value,o=yield t.loadingCtrl.create({message:"Updating user ..."}),s=yield t.toastCtrl.create({message:"Successfully updated user.",duration:2e3,color:"success"});o.present();const h=new FormData;if(t.croppedImage){const g=t.photoService.dataURItoBlob(t.croppedImage);h.append("photo",g)}(yield t.accountService.updateUser({id:i.id,email:i.email,firstName:a,lastName:r,role:i.role,subscription:i.subscription,tier:i.tier,isUpdatePhoto:!!t.currentPhoto,tier1AdminEnabled:t.accountService.currentUser.tier1AdminEnabled,tier1UserEnabled:t.accountService.currentUser.tier1UserEnabled,tier1PercentLevel:t.accountService.currentUser.tier1PercentLevel,...t.currentPhoto&&{formData:h}}))&&(t.accountService.user(i.id.toString()),s.present()),o.dismiss()}})()}uploadPhoto(){var t=this;return(0,S.Z)(function*(){const i=yield t.photoService.promptPhotoBase64();t.currentPhoto=i,yield(yield t.loadingCtrl.create()).present(),t.myImage=`data:image/jpeg;base64,${i.base64String}`,t.croppedImage=null})()}imageLoaded(){this.loadingCtrl.dismiss()}loadImageFailed(){this.loadingCtrl.dismiss()}cropImage(){this.croppedImage=this.cropper.crop().base64,this.myImage=null}cancelSubscription(){var t=this;return(0,S.Z)(function*(){yield(yield t.alertController.create({header:"Are you sure you want to cancel your subscription?",buttons:[{text:"Cancel",role:"cancel"},{text:"Confirm",role:"confirm",handler:()=>{t.accountService.cancelSubscription(t.accountService.currentUser.id)}}]})).present()})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_.qu),e.Y36(pt.B),e.Y36(gt.T),e.Y36(m.HT),e.Y36(m.yF),e.Y36(m.Br))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-user-profile"]],viewQuery:function(t,i){if(1&t&&e.Gf(lt,5),2&t){let a;e.iGM(a=e.CRH())&&(i.cropper=a.first)}},decls:36,vars:8,consts:[["mode","ios"],["slot","start"],["mode","md"],["slot","end",4,"ngIf"],["class","ion-padding-vertical ion-justify-content-center","style","display: flex;",3,"click",4,"ngIf"],["format","png",3,"imageBase64","maintainAspectRatio","aspectRatio","imageLoaded","loadImageFailed",4,"ngIf"],[1,"ion-padding-vertical",3,"formGroup"],["position","floating"],["type","text","disabled","true",3,"value"],[1,"ion-padding-bottom","ion-margin-bottom"],["formControlName","firstName","type","text"],["color","danger"],[4,"ngIf"],["formControlName","lastName","type","text"],["expand","block","color","dark",1,"ion-margin",3,"click"],["slot","end"],[3,"click"],["slot","icon-only","name","checkmark",1,"check-icon"],[1,"ion-padding-vertical","ion-justify-content-center",2,"display","flex",3,"click"],["alt","user-profile-image",3,"src",4,"ngIf"],["alt","user-profile-image",3,"src"],["format","png",3,"imageBase64","maintainAspectRatio","aspectRatio","imageLoaded","loadImageFailed"],["cropper",""]],template:function(t,i){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button",2),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"User Profile"),e.qZA(),e.YNc(6,mt,3,0,"ion-buttons",3),e.qZA()(),e.TgZ(7,"ion-content"),e.YNc(8,ut,4,2,"div",4),e.YNc(9,xt,2,3,"image-cropper",5),e.TgZ(10,"form",6)(11,"ion-item")(12,"ion-label",7),e._uU(13,"Email"),e.qZA(),e._UZ(14,"ion-input",8),e.qZA(),e._UZ(15,"div",9),e.TgZ(16,"ion-item")(17,"ion-label",7),e._uU(18,"First name"),e.qZA(),e._UZ(19,"ion-input",10),e.qZA(),e.TgZ(20,"div",9)(21,"ion-text",11),e.YNc(22,_t,2,0,"small",12),e.qZA()(),e.TgZ(23,"ion-item")(24,"ion-label",7),e._uU(25,"Last name"),e.qZA(),e._UZ(26,"ion-input",13),e.qZA(),e.TgZ(27,"div",9)(28,"ion-text",11),e.YNc(29,Mt,2,0,"small",12),e.qZA()(),e.TgZ(30,"ion-item")(31,"ion-label",7),e._uU(32,"Subscription"),e.qZA(),e._UZ(33,"ion-input",8),e.qZA(),e.TgZ(34,"ion-button",14),e.NdJ("click",function(){return i.save()}),e._uU(35,"Save"),e.qZA()()()),2&t&&(e.xp6(6),e.Q6J("ngIf",i.myImage),e.xp6(2),e.Q6J("ngIf",!i.myImage),e.xp6(1),e.Q6J("ngIf",i.myImage),e.xp6(1),e.Q6J("formGroup",i.userProfileForm),e.xp6(4),e.Q6J("value",i.userEmail),e.xp6(8),e.Q6J("ngIf",!i.userProfileForm.get("firstName").valid&&(i.userProfileForm.get("firstName").dirty||i.userProfileForm.get("firstName").touched)),e.xp6(7),e.Q6J("ngIf",!i.userProfileForm.get("lastName").valid&&(i.userProfileForm.get("lastName").dirty||i.userProfileForm.get("lastName").touched)),e.xp6(4),e.Q6J("value",i.userSubscriptionName))},dependencies:[R.O5,_._Y,_.JJ,_.JL,m.BJ,m.oU,m.YG,m.Sm,m.W2,m.Gu,m.gu,m.pK,m.Ie,m.Q$,m.yW,m.wd,m.sr,m.j9,m.cs,_.sg,_.u,ct],styles:["ion-avatar[_ngcontent-%COMP%]{width:150px;height:150px}.check-icon[_ngcontent-%COMP%]{color:#fff}ion-title[_ngcontent-%COMP%]{text-transform:uppercase;font-size:18px}"]}),n})()}];let At=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[W.Bz.forChild(Ct),W.Bz]}),n})(),yt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[R.ez,_.u5,m.Pc,_.UX,At,ht]}),n})()}}]);