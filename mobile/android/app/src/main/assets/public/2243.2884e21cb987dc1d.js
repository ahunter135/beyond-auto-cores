"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2243],{4190:(I,y,l)=>{l.d(y,{s:()=>t});var p=l(4850),_=l(7221),a=l(2868),h=l(591),g=l(1737),b=l(7631),P=l(1102);let t=(()=>{class m{constructor(s){this.rest=s,this.isLoadingMore=!1,this.selectLotStateSubject=new h.X(null)}get selectedLot(){return this.selectLotStateSubject.value}set setSelectedLot(s){this.selectLotStateSubject.next(s)}lots(s){return this.rest.get({endpoint:"/lots",params:s}).pipe((0,p.U)(r=>{const{data:c}=r.body;return c}),(0,_.K)(r=>(0,g._)(r))).toPromise()}inventory(s){return this.rest.get({endpoint:"/lots/inventory",params:s}).pipe((0,p.U)(r=>{const{data:c,pagination:v}=r.body;return{data:c,pagination:v}}),(0,_.K)(r=>(0,g._)(r))).toPromise()}inventorySummary(s){return this.rest.get({endpoint:"/lots/inventorysummary",params:s}).pipe((0,p.U)(r=>{const{data:c,pagination:v}=r.body;return{data:c,pagination:v}}),(0,_.K)(r=>(0,g._)(r))).toPromise()}nextInventory(s){return this.isLoadingMore=!0,this.rest.get({endpoint:s,server:"none"}).pipe((0,p.U)(r=>{const{data:c,pagination:v}=r.body;return{data:c,pagination:v}}),(0,a.b)(()=>this.isLoadingMore=!1),(0,_.K)(r=>(0,g._)(r))).toPromise()}addlot(s){return this.rest.post("/lots",s).pipe((0,p.U)(r=>{const{data:c}=r.body;return c}),(0,_.K)(r=>(0,g._)(r))).toPromise()}updateLot(s){return this.rest.put("/lots",s).pipe((0,p.U)(r=>{const{data:c}=r.body;return c}),(0,_.K)(r=>(0,g._)(r))).toPromise()}deletelot(s){return this.rest.delete(`/lots/${s}`).pipe((0,p.U)(r=>{const{data:c}=r.body;return c}),(0,_.K)(r=>(0,g._)(r))).toPromise()}submitLot(s){return this.rest.post({endpoint:"/lots/submit",params:{lotId:s.lotId,businessName:s.businessName,email:s.email}},s.formData,!1,!0).pipe((0,p.U)(r=>{const{data:c}=r.body;return c}),(0,_.K)(r=>(0,g._)(r))).toPromise()}}return m.\u0275fac=function(s){return new(s||m)(b.LFG(P.v))},m.\u0275prov=b.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},2243:(I,y,l)=>{l.r(y),l.d(y,{InventoryPageModule:()=>J});var p=l(6895),_=l(4719),a=l(2478),h=l(1065),g=l(5861),b=l(9),P=l(4300),t=l(7631),m=l(4190),C=l(5904),s=l(3866),r=l(1687);const c=["content"];function v(o,d){1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-skeleton-list-loader"),t.qZA())}function M(o,d){if(1&o&&(t.TgZ(0,"ion-text",24),t._uU(1),t.qZA()),2&o){const e=t.oxw().$implicit;t.xp6(1),t.hij("Invoice: ",e.invoiceNo,"")}}function Z(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"ion-card",14),t.NdJ("click",function(){const u=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.goToLotList(u))}),t.TgZ(1,"div",15),t.NdJ("click",function(i){const f=t.CHM(e).$implicit,x=t.oxw();return t.KtG(x.deleteLot(i,f))}),t._UZ(2,"ion-icon",16),t.qZA(),t.TgZ(3,"ion-card-content",17)(4,"ion-row")(5,"ion-col",18)(6,"ion-text",19),t._uU(7),t.qZA(),t._UZ(8,"br"),t.YNc(9,M,2,1,"ion-text",20),t.qZA(),t.TgZ(10,"ion-col",21)(11,"ion-text",22),t._uU(12),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"ion-text",22),t._uU(15,"Average: "),t.qZA(),t.TgZ(16,"ion-text",22),t._uU(17),t.qZA(),t._UZ(18,"br"),t.TgZ(19,"ion-text",22),t._uU(20,"Total: "),t.qZA(),t.TgZ(21,"ion-text",22),t._uU(22),t.qZA()(),t.TgZ(23,"ion-col",23)(24,"ion-text",24),t._uU(25),t.qZA()()()()()}if(2&o){const e=d.$implicit,n=t.oxw();t.xp6(7),t.Oqu(e.lotName),t.xp6(2),t.Q6J("ngIf","active"!==n.defaultSegment),t.xp6(3),t.hij("Quantity: ",e.quantity||0," "),t.xp6(5),t.Oqu(n.formatPrice(e.average||0)),t.xp6(5),t.Oqu(n.formatPrice(e.total||0)),t.xp6(3),t.Oqu(n.formatDate(e.createdOn))}}function T(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"ion-infinite-scroll",25),t.NdJ("ionInfinite",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.onIonInfinite(i))}),t._UZ(1,"ion-infinite-scroll-content"),t.qZA()}}function O(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"ion-infinite-scroll",25),t.NdJ("ionInfinite",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.onIonInfinite(i))}),t._UZ(1,"ion-infinite-scroll-content"),t.qZA()}}function L(o,d){1&o&&(t.TgZ(0,"ion-text",26),t._uU(1,"Create a New Inventory Lot"),t.qZA())}function S(o,d){1&o&&(t.TgZ(0,"ion-text",26),t._uU(1,"Upgrade your Subscription to Create Lots"),t.qZA())}function U(o,d){if(1&o){const e=t.EpF();t.TgZ(0,"ion-content",27)(1,"ion-toolbar",28)(2,"ion-buttons",29)(3,"ion-text",30),t._uU(4,"Add New Lot"),t.qZA()(),t.TgZ(5,"ion-buttons",31)(6,"ion-button",32),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(20);return t.KtG(i.dismiss())}),t._UZ(7,"ion-icon",33),t.qZA()()(),t.TgZ(8,"div",34)(9,"ion-text",35),t._uU(10,"Lot Name"),t.qZA()(),t.TgZ(11,"div",1)(12,"ion-input",36),t.NdJ("ngModelChange",function(i){t.CHM(e);const u=t.oxw();return t.KtG(u.lotName=i)}),t.qZA()(),t.TgZ(13,"ion-footer",37)(14,"div",38)(15,"ion-button",39),t.NdJ("click",function(){t.CHM(e),t.oxw();const i=t.MAs(20);return t.KtG(i.dismiss())}),t.TgZ(16,"ion-text",26),t._uU(17,"Cancel"),t.qZA()(),t.TgZ(18,"ion-button",40),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onCreateLot())}),t.TgZ(19,"ion-text",41),t._uU(20,"Create Lot"),t.qZA()()()()()}if(2&o){const e=t.oxw();t.xp6(12),t.Q6J("ngModel",e.lotName),t.xp6(6),t.uIk("disabled",!e.lotName)}}const A=[{path:"",component:(()=>{class o{constructor(e,n,i,u,f,x){this.route=e,this.modalCtrl=n,this.lotsService=i,this.loadingCtrl=u,this.accountService=f,this.alertController=x,this.defaultSegment="active",this.lots={data:[],pagination:null},this.isLoading=!1,this.activeSegment="active",this.userSubscription=0}ngOnInit(){this.onLoad()}ngOnDestroy(){this.navigationSubscription&&this.navigationSubscription.unsubscribe()}onLoad(){var e=this;return(0,g.Z)(function*(){e.defaultSegment="active",e.lots={data:[],pagination:null},e.isLoading=!0,e.lots=yield e.lotsService.inventorySummary({pageNumber:1,pageSize:100,searchCategory:"isSubmitted",searchQuery:"false"}),e.userSubscription=e.accountService.currentUser.subscription,e.sortLots(),e.isLoading=!1})()}segmentChanged(e){var n=this;return(0,g.Z)(function*(){n.content.scrollToTop(0);const i=e;n.activeSegment=i.detail.value,i.detail.value!==n.defaultSegment&&(n.isLoading=!0,n.lots={data:[],pagination:null},n.defaultSegment=i.detail.value,n.lots=yield n.lotsService.inventorySummary({pageNumber:1,pageSize:100,..."closed"===n.defaultSegment?{searchCategory:"isSubmitted",searchQuery:"true"}:{searchCategory:"isSubmitted",searchQuery:"false"}}),n.sortLots(),n.isLoading=!1)})()}goToLotList(e){this.lotsService.setSelectedLot=e,this.route.navigate(["lot-list"])}onCreateLot(){var e=this;return(0,g.Z)(function*(){const n=yield e.loadingCtrl.create({message:"Creating new lot ..."});n.present();const i=yield e.lotsService.addlot({lotName:e.lotName});e.modalCtrl.dismiss(),e.lots.data=[i,...e.lots.data],n.dismiss()})()}onIonInfinite(e){var n=this;return(0,g.Z)(function*(){const i=n.lots?.pagination?.nextPageLink;if(n.isLoading=!0,i&&!n.lotsService.isLoadingMore){const{data:u,pagination:f}=yield n.lotsService.nextInventory(i);n.lots={data:[...n.lots.data,...u],pagination:f}}n.isLoading=!1,n.sortLots(),setTimeout(()=>{e.target.complete()},500)})()}sortLots(){this.lots.data.sort(function e(n,i){return new Date(i.createdOn).getTime()-new Date(n.createdOn).getTime()})}deleteLot(e,n){var i=this;return(0,g.Z)(function*(){var f;e.stopPropagation(),yield(yield i.alertController.create({header:"Alert",message:"Are you sure you would like to delete this lot?",buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Yes",role:"confirm",handler:(f=(0,g.Z)(function*(){const x=yield i.loadingCtrl.create({message:`Deleting ${n.lotName} ...`});x.present(),(yield i.lotsService.deletelot(n.lotId))&&i.lots.data.splice(i.lots.data.indexOf(n),1),x.dismiss()}),function(){return f.apply(this,arguments)})}]})).present()})()}clear(){this.lotName=""}formatDate(e){return(0,P.h)(e,"MM/DD/YYYY")}formatPrice(e){return(0,b.O)(e)}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(h.F0),t.Y36(a.IN),t.Y36(m.s),t.Y36(a.HT),t.Y36(C.B),t.Y36(a.Br))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-inventory"]],viewQuery:function(e,n){if(1&e&&t.Gf(c,5),2&e){let i;t.iGM(i=t.CRH())&&(n.content=i.first)}},decls:22,vars:10,consts:[["title","Inventory"],[1,"ion-padding"],["mode","ios",3,"value","ionChange"],["value","active"],["value","closed"],[1,"ion-padding-start","ion-padding-end"],["content",""],[4,"ngIf"],["class","inventory-card-item",3,"click",4,"ngFor","ngForOf"],["threshold","200px",3,"ionInfinite",4,"ngIf"],["id","inventory-modal","expand","block",1,"create-inventory-button",3,"disabled","click"],["class","paragraph-text-16-semibold",4,"ngIf"],["trigger","inventory-modal",3,"animated"],["modal",""],[1,"inventory-card-item",3,"click"],[1,"inventory-delete-button-wrapper",3,"click"],["slot","icon-only","name","close-outline",1,"inventory-delete-button"],[1,"inventory-card-item-content"],["size","4",1,"ion-text-start","inventory-item-col","truncate"],[1,"paragraph-text-14-bold","white"],["class","paragraph-text-10 white",4,"ngIf"],["size","4",1,"ion-text-start","inventory-item-col"],[1,"paragraph-text-12","white"],["size","4",1,"ion-text-center","inventory-item-col"],[1,"paragraph-text-10","white"],["threshold","200px",3,"ionInfinite"],[1,"paragraph-text-16-semibold"],[1,"lot-content"],["mode","ios"],["slot","start"],[1,"paragraph-text-14-bold"],["slot","end"],["color","light",3,"click"],["name","close-outline"],[1,"ion-padding-start","ion-padding-end","ion-padding-top"],[1,"black-500","paragraph-text-14-bold"],["placeholder","12345678",1,"lot-input",3,"ngModel","ngModelChange"],[1,"modal-footer"],[1,"footer-button"],["color","dark",1,"ion-text-capitalize","cancel-lot-button",3,"click"],[1,"create-lot-button",3,"click"],[1,"paragraph-text-16-semibold","white"]],template:function(e,n){1&e&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"ion-segment",2),t.NdJ("ionChange",function(u){return n.segmentChanged(u)}),t.TgZ(3,"ion-segment-button",3)(4,"ion-label"),t._uU(5,"Active"),t.qZA()(),t.TgZ(6,"ion-segment-button",4)(7,"ion-label"),t._uU(8,"Closed"),t.qZA()()()(),t.TgZ(9,"ion-content",5,6),t.YNc(11,v,2,0,"div",7),t.YNc(12,Z,26,6,"ion-card",8),t.YNc(13,T,2,0,"ion-infinite-scroll",9),t.YNc(14,O,2,0,"ion-infinite-scroll",9),t.qZA(),t.TgZ(15,"ion-footer",1)(16,"ion-button",10),t.NdJ("click",function(){return n.clear()}),t.YNc(17,L,2,0,"ion-text",11),t.YNc(18,S,2,0,"ion-text",11),t.qZA()(),t.TgZ(19,"ion-modal",12,13),t.YNc(21,U,21,2,"ng-template"),t.qZA()),2&e&&(t.xp6(2),t.Q6J("value",n.activeSegment),t.uIk("disabled",n.isLoading),t.xp6(9),t.Q6J("ngIf",n.isLoading&&!n.lots.data),t.xp6(1),t.Q6J("ngForOf",n.lots.data),t.xp6(1),t.Q6J("ngIf","active"===n.defaultSegment),t.xp6(1),t.Q6J("ngIf","closed"===n.defaultSegment),t.xp6(2),t.Q6J("disabled",1==n.userSubscription),t.xp6(1),t.Q6J("ngIf",2==n.userSubscription||3==n.userSubscription),t.xp6(1),t.Q6J("ngIf",1==n.userSubscription),t.xp6(1),t.Q6J("animated",!1))},dependencies:[p.sg,p.O5,_.JJ,_.On,a.YG,a.Sm,a.PM,a.FN,a.wI,a.W2,a.fr,a.gu,a.ju,a.MB,a.pK,a.Q$,a.Nd,a.cJ,a.GO,a.yW,a.sr,a.ki,a.QI,a.j9,s.G,r.f],styles:["ion-segment-button[_ngcontent-%COMP%]{--color: #ffffff80;--background-checked: #000;--color-checked: #000000;--indicator-color: #ffffff}ion-segment[_ngcontent-%COMP%]{--background: #000000;--color: #ffffff80;width:250px;margin:auto}.create-inventory-button[_ngcontent-%COMP%]{--background: #000;--border-radius: 12px;height:46px;text-transform:capitalize}ion-footer[_ngcontent-%COMP%]{border:0px}.inventory-card-item[_ngcontent-%COMP%]{padding:0!important;margin:10px 0!important;height:86px;position:relative}.inventory-delete-button[_ngcontent-%COMP%]{color:red;font-size:26px}.inventory-delete-button-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:10;right:5px;top:5px}ion-modal[_ngcontent-%COMP%]{--height: 264px;--border-radius: 16px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--background: #fff;overflow:auto}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}ion-modal[_ngcontent-%COMP%]::part(backdrop){background:#000000;opacity:.5}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0)}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9;border-radius:6px;border:1px solid #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}ion-modal[_ngcontent-%COMP%]::part(content){--width: 90%;max-width:512px;--border-radius: 6px}ion-footer[_ngcontent-%COMP%]{position:relative;padding-top:20px}.footer-group-button[_ngcontent-%COMP%]{width:100%}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:0;bottom:5px}.create-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.inventory-item-col[_ngcontent-%COMP%]{line-height:12px}.create-lot-button[_ngcontent-%COMP%]{border-radius:6px;--background: #000000;width:144px;height:40px;margin-right:22px}.cancel-lot-button[_ngcontent-%COMP%]{border-radius:6px;width:85px;height:40px}ion-toolbar[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid #eff2f5}"]}),o})()}];let N=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(A),h.Bz]}),o})();var k=l(1075);let J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[p.ez,_.u5,a.Pc,N,k.m]}),o})()}}]);