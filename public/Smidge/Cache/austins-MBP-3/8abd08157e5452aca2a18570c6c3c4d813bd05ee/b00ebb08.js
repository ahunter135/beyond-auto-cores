(function(){"use strict";function seedController($scope,uSyncPublishService){function getServer(url){uSyncPublishService.getServerByUrl(url).then(function(result){vm.server=result.data;setTitle(vm.server);vm.loading=!1})}function setTitle(server){var parent=$scope.$parent;parent!=null&&parent.vm!=null&&parent.vm.headings!=null&&(parent.vm.headings.title="Seed from "+server.name,parent.vm.headings.description="Selec the items you want to pull from the "+server.name+" instance")}var vm=this,evts;vm.loading=!0;vm.seedUrl=Umbraco.Sys.ServerVariables.uSyncPublisher.seedUrl;getServer(vm.seedUrl);vm.process=$scope.$parent.vm.process;vm.flags={includeChildren:{toggle:!0,value:!0},includeDecendants:{toggle:!0,value:!0},includeMedia:{toggle:!1,value:!1},includeLinked:{toggle:!1,value:!1},includeAncestors:{toggle:!1,value:!1},includeDependencies:{toggle:!1,value:!1},includeFiles:{toggle:!1,value:!0},includeMediaFiles:{toggle:!1,value:!1},deleteMissing:{toggle:!1,value:!1},includeSystemFiles:{toggle:!1,value:!1}};vm.flagsValue=uSyncPublishService.getFlags(vm.flags);vm.emptyGuid="00000000-0000-0000-0000-000000000000";vm.emptyString="";vm.groups=[{name:"Settings",icon:"icon-settings",selected:!0,items:[{name:"document-type",root:vm.emptyGuid},{name:"data-type",root:vm.emptyGuid},{name:"media-type",root:vm.emptyGuid},{name:"domain",root:vm.emptyGuid},{name:"member-type",root:vm.emptyGuid},{name:"dictionary-item",root:vm.emptyGuid},{name:"macro",root:vm.emptyGuid},{name:"template",root:vm.emptyGuid},{name:"language",root:vm.emptyString},]},{name:"Content",icon:"icon-documents",items:[{name:"document",root:vm.emptyGuid},{name:"protect",root:vm.emptyGuid}]},{name:"Media",icon:"icon-pictures-alt",items:[{name:"media",root:vm.emptyGuid}]}];evts=[];evts.push($scope.$watch("vm.groups",function(newValue){vm.process.items=[];_.each(newValue,function(group){group.selected&&_.each(group.items,function(item){vm.process.items.push({udi:"umb://"+item.name+"/"+item.root,name:item.name,flags:vm.flagsValue})})});$scope.$parent.vm.state.valid=vm.process.items.length==0?!1:!0},!0));$scope.$on("$destroy",function(){for(var u in evts)evts[u]()})}angular.module("umbraco").controller("uSyncPublisherSeedController",seedController)})()