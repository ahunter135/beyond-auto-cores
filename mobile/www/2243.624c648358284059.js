"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2243],{4190:(I,x,a)=>{a.d(x,{s:()=>P});var u=a(4850),p=a(7221),s=a(2868),h=a(591),d=a(1737),y=a(7631),b=a(1102);let P=(()=>{class m{constructor(t){this.rest=t,this.isLoadingMore=!1,this.selectLotStateSubject=new h.X(null)}get selectedLot(){return this.selectLotStateSubject.value}set setSelectedLot(t){this.selectLotStateSubject.next(t)}lots(t){return this.rest.get({endpoint:"/lots",params:t}).pipe((0,u.U)(r=>{const{data:l}=r.body;return l}),(0,p.K)(r=>(0,d._)(r))).toPromise()}inventory(t){return this.rest.get({endpoint:"/lots/inventory",params:t}).pipe((0,u.U)(r=>{const{data:l,pagination:v}=r.body;return{data:l,pagination:v}}),(0,p.K)(r=>(0,d._)(r))).toPromise()}inventorySummary(t){return this.rest.get({endpoint:"/lots/inventorysummary",params:t}).pipe((0,u.U)(r=>{const{data:l,pagination:v}=r.body;return{data:l,pagination:v}}),(0,p.K)(r=>(0,d._)(r))).toPromise()}nextInventory(t){return this.isLoadingMore=!0,this.rest.get({endpoint:t,server:"none"}).pipe((0,u.U)(r=>{const{data:l,pagination:v}=r.body;return{data:l,pagination:v}}),(0,s.b)(()=>this.isLoadingMore=!1),(0,p.K)(r=>(0,d._)(r))).toPromise()}addlot(t){return this.rest.post("/lots",t).pipe((0,u.U)(r=>{const{data:l}=r.body;return l}),(0,p.K)(r=>(0,d._)(r))).toPromise()}updateLot(t){return this.rest.put("/lots",t).pipe((0,u.U)(r=>{const{data:l}=r.body;return l}),(0,p.K)(r=>(0,d._)(r))).toPromise()}deletelot(t){return this.rest.delete(`/lots/${t}`).pipe((0,u.U)(r=>{const{data:l}=r.body;return l}),(0,p.K)(r=>(0,d._)(r))).toPromise()}submitLot(t){return this.rest.post({endpoint:"/lots/submit",params:{lotId:t.lotId,businessName:t.businessName,email:t.email}},t.formData,!1,!0).pipe((0,u.U)(r=>{const{data:l}=r.body;return l}),(0,p.K)(r=>(0,d._)(r))).toPromise()}}return m.\u0275fac=function(t){return new(t||m)(y.LFG(b.v))},m.\u0275prov=y.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},2243:(I,x,a)=>{a.r(x),a.d(x,{InventoryPageModule:()=>D});var u=a(6895),p=a(4719),s=a(2478),h=a(1065),d=a(5861),y=a(9),b=a(4300),P=a(5529),m=a(2198),C=a(7625),t=a(7631),r=a(4190),l=a(5904),v=a(3866),M=a(1687);const Z=["content"];function T(o,c){1&o&&(t.TgZ(0,"div"),t._UZ(1,"app-skeleton-list-loader"),t.qZA())}function S(o,c){if(1&o&&(t.TgZ(0,"ion-text",24),t._uU(1),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij("Invoice: ",n.invoiceNo,"")}}function L(o,c){if(1&o){const n=t.EpF();t.TgZ(0,"ion-card",14),t.NdJ("click",function(){const g=t.CHM(n).$implicit,f=t.oxw();return t.KtG(f.goToLotList(g))}),t.TgZ(1,"div",15),t.NdJ("click",function(i){const f=t.CHM(n).$implicit,_=t.oxw();return t.KtG(_.deleteLot(i,f))}),t._UZ(2,"ion-icon",16),t.qZA(),t.TgZ(3,"ion-card-content",17)(4,"ion-row")(5,"ion-col",18)(6,"ion-text",19),t._uU(7),t.qZA(),t._UZ(8,"br"),t.YNc(9,S,2,1,"ion-text",20),t.qZA(),t.TgZ(10,"ion-col",21)(11,"ion-text",22),t._uU(12),t.qZA(),t._UZ(13,"br"),t.TgZ(14,"ion-text",22),t._uU(15,"Average: "),t.qZA(),t.TgZ(16,"ion-text",22),t._uU(17),t.qZA(),t._UZ(18,"br"),t.TgZ(19,"ion-text",22),t._uU(20,"Total: "),t.qZA(),t.TgZ(21,"ion-text",22),t._uU(22),t.qZA()(),t.TgZ(23,"ion-col",23)(24,"ion-text",24),t._uU(25),t.qZA()()()()()}if(2&o){const n=c.$implicit,e=t.oxw();t.xp6(7),t.Oqu(n.lotName),t.xp6(2),t.Q6J("ngIf","active"!==e.defaultSegment),t.xp6(3),t.hij("Quantity: ",n.quantity||0," "),t.xp6(5),t.Oqu(e.formatPrice(n.average||0)),t.xp6(5),t.Oqu(e.formatPrice(n.total||0)),t.xp6(3),t.Oqu(e.formatDate(n.createdOn))}}function O(o,c){if(1&o){const n=t.EpF();t.TgZ(0,"ion-infinite-scroll",25),t.NdJ("ionInfinite",function(i){t.CHM(n);const g=t.oxw();return t.KtG(g.onIonInfinite(i))}),t._UZ(1,"ion-infinite-scroll-content"),t.qZA()}}function U(o,c){if(1&o){const n=t.EpF();t.TgZ(0,"ion-infinite-scroll",25),t.NdJ("ionInfinite",function(i){t.CHM(n);const g=t.oxw();return t.KtG(g.onIonInfinite(i))}),t._UZ(1,"ion-infinite-scroll-content"),t.qZA()}}function A(o,c){1&o&&(t.TgZ(0,"ion-text",26),t._uU(1,"Create a New Inventory Lot"),t.qZA())}function N(o,c){1&o&&(t.TgZ(0,"ion-text",26),t._uU(1,"Upgrade your Subscription to Create Lots"),t.qZA())}function E(o,c){if(1&o){const n=t.EpF();t.TgZ(0,"ion-content",27)(1,"ion-toolbar",28)(2,"ion-buttons",29)(3,"ion-text",30),t._uU(4,"Add New Lot"),t.qZA()(),t.TgZ(5,"ion-buttons",31)(6,"ion-button",32),t.NdJ("click",function(){t.CHM(n),t.oxw();const i=t.MAs(20);return t.KtG(i.dismiss())}),t._UZ(7,"ion-icon",33),t.qZA()()(),t.TgZ(8,"div",34)(9,"ion-text",35),t._uU(10,"Lot Name"),t.qZA()(),t.TgZ(11,"div",1)(12,"ion-input",36),t.NdJ("ngModelChange",function(i){t.CHM(n);const g=t.oxw();return t.KtG(g.lotName=i)}),t.qZA()(),t.TgZ(13,"ion-footer",37)(14,"div",38)(15,"ion-button",39),t.NdJ("click",function(){t.CHM(n),t.oxw();const i=t.MAs(20);return t.KtG(i.dismiss())}),t.TgZ(16,"ion-text",26),t._uU(17,"Cancel"),t.qZA()(),t.TgZ(18,"ion-button",40),t.NdJ("click",function(){t.CHM(n);const i=t.oxw();return t.KtG(i.onCreateLot())}),t.TgZ(19,"ion-text",41),t._uU(20,"Create Lot"),t.qZA()()()()()}if(2&o){const n=t.oxw();t.xp6(12),t.Q6J("ngModel",n.lotName),t.xp6(6),t.uIk("disabled",!n.lotName)}}const J=[{path:"",component:(()=>{class o{constructor(n,e,i,g,f,_){this.route=n,this.modalCtrl=e,this.lotsService=i,this.loadingCtrl=g,this.accountService=f,this.alertController=_,this.defaultSegment="active",this.lots={data:[],pagination:null},this.isLoading=!1,this.closed$=new P.xQ,this.activeSegment="active",this.userSubscription=0}ionViewWillEnter(){this.onLoad(),this.navigationSubscription=this.route.events.pipe((0,m.h)(n=>n instanceof h.m2),(0,C.R)(this.closed$)).subscribe(n=>{console.log(n.url),"/tabs/tabs/inventory"===n.url&&this.onLoad()})}ngOnDestroy(){this.navigationSubscription&&this.navigationSubscription.unsubscribe()}onLoad(){var n=this;return(0,d.Z)(function*(){n.defaultSegment="active",n.activeSegment=n.defaultSegment,n.lots={data:[],pagination:null},n.isLoading=!0,n.lots=yield n.lotsService.inventorySummary({pageNumber:1,pageSize:100,searchCategory:"isSubmitted",searchQuery:"false"}),n.userSubscription=n.accountService.currentUser.subscription,n.sortLots(),n.isLoading=!1})()}segmentChanged(n){var e=this;return(0,d.Z)(function*(){e.content.scrollToTop(0);const i=n;e.activeSegment=i.detail.value,i.detail.value!==e.defaultSegment&&(e.isLoading=!0,e.lots={data:[],pagination:null},e.defaultSegment=i.detail.value,e.activeSegment=e.defaultSegment,e.lots=yield e.lotsService.inventorySummary({pageNumber:1,pageSize:100,..."closed"===e.defaultSegment?{searchCategory:"isSubmitted",searchQuery:"true"}:{searchCategory:"isSubmitted",searchQuery:"false"}}),e.sortLots(),e.isLoading=!1)})()}goToLotList(n){this.lotsService.setSelectedLot=n,this.route.navigate(["lot-list"])}onCreateLot(){var n=this;return(0,d.Z)(function*(){const e=yield n.loadingCtrl.create({message:"Creating new lot ..."});e.present();const i=yield n.lotsService.addlot({lotName:n.lotName});n.modalCtrl.dismiss(),n.lots.data=[i,...n.lots.data],e.dismiss()})()}onIonInfinite(n){var e=this;return(0,d.Z)(function*(){const i=e.lots?.pagination?.nextPageLink;if(e.isLoading=!0,i&&!e.lotsService.isLoadingMore){const{data:g,pagination:f}=yield e.lotsService.nextInventory(i);e.lots={data:[...e.lots.data,...g],pagination:f}}e.isLoading=!1,e.sortLots(),setTimeout(()=>{n.target.complete()},500)})()}sortLots(){this.lots.data.sort(function n(e,i){return new Date(i.createdOn).getTime()-new Date(e.createdOn).getTime()})}deleteLot(n,e){var i=this;return(0,d.Z)(function*(){var f;n.stopPropagation(),yield(yield i.alertController.create({header:"Alert",message:"Are you sure you would like to delete this lot?",buttons:[{text:"Cancel",role:"cancel",handler:()=>{}},{text:"Yes",role:"confirm",handler:(f=(0,d.Z)(function*(){const _=yield i.loadingCtrl.create({message:`Deleting ${e.lotName} ...`});_.present(),(yield i.lotsService.deletelot(e.lotId))&&i.lots.data.splice(i.lots.data.indexOf(e),1),_.dismiss()}),function(){return f.apply(this,arguments)})}]})).present()})()}clear(){this.lotName=""}formatDate(n){return(0,b.h)(n,"MM/DD/YYYY")}formatPrice(n){return(0,y.O)(n)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(h.F0),t.Y36(s.IN),t.Y36(r.s),t.Y36(s.HT),t.Y36(l.B),t.Y36(s.Br))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-inventory"]],viewQuery:function(n,e){if(1&n&&t.Gf(Z,5),2&n){let i;t.iGM(i=t.CRH())&&(e.content=i.first)}},decls:22,vars:11,consts:[["title","Inventory"],[1,"ion-padding"],["mode","ios",3,"value","ionChange"],["value","active"],["value","closed"],[1,"ion-padding-start","ion-padding-end"],["content",""],[4,"ngIf"],["class","inventory-card-item",3,"click",4,"ngFor","ngForOf"],["threshold","200px",3,"ionInfinite",4,"ngIf"],["id","inventory-modal","expand","block",1,"create-inventory-button",3,"disabled","click"],["class","paragraph-text-16-semibold",4,"ngIf"],["trigger","inventory-modal",3,"animated"],["modal",""],[1,"inventory-card-item",3,"click"],[1,"inventory-delete-button-wrapper",3,"click"],["slot","icon-only","name","close-outline",1,"inventory-delete-button"],[1,"inventory-card-item-content"],["size","4",1,"ion-text-start","inventory-item-col","truncate"],[1,"paragraph-text-14-bold","white"],["class","paragraph-text-10 white",4,"ngIf"],["size","4",1,"ion-text-start","inventory-item-col"],[1,"paragraph-text-12","white"],["size","4",1,"ion-text-center","inventory-item-col"],[1,"paragraph-text-10","white"],["threshold","200px",3,"ionInfinite"],[1,"paragraph-text-16-semibold"],[1,"lot-content"],["mode","ios"],["slot","start"],[1,"paragraph-text-14-bold"],["slot","end"],["color","light",3,"click"],["name","close-outline"],[1,"ion-padding-start","ion-padding-end","ion-padding-top"],[1,"black-500","paragraph-text-14-bold"],["placeholder","12345678",1,"lot-input",3,"ngModel","ngModelChange"],[1,"modal-footer"],[1,"footer-button"],["color","dark",1,"ion-text-capitalize","cancel-lot-button",3,"click"],[1,"create-lot-button",3,"click"],[1,"paragraph-text-16-semibold","white"]],template:function(n,e){1&n&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"ion-segment",2),t.NdJ("ionChange",function(g){return e.segmentChanged(g)}),t.TgZ(3,"ion-segment-button",3)(4,"ion-label"),t._uU(5,"Active"),t.qZA()(),t.TgZ(6,"ion-segment-button",4)(7,"ion-label"),t._uU(8,"Closed"),t.qZA()()()(),t.TgZ(9,"ion-content",5,6),t.YNc(11,T,2,0,"div",7),t.YNc(12,L,26,6,"ion-card",8),t.YNc(13,O,2,0,"ion-infinite-scroll",9),t.YNc(14,U,2,0,"ion-infinite-scroll",9),t.qZA(),t.TgZ(15,"ion-footer",1)(16,"ion-button",10),t.NdJ("click",function(){return e.clear()}),t.YNc(17,A,2,0,"ion-text",11),t.YNc(18,N,2,0,"ion-text",11),t.qZA()(),t.TgZ(19,"ion-modal",12,13),t.YNc(21,E,21,2,"ng-template"),t.qZA()),2&n&&(t.xp6(2),t.Q6J("value",e.activeSegment),t.uIk("disabled",e.isLoading),t.xp6(9),t.Q6J("ngIf",e.isLoading&&!e.lots.data),t.xp6(1),t.Q6J("ngForOf",e.lots.data),t.xp6(1),t.Q6J("ngIf","active"===e.defaultSegment),t.xp6(1),t.Q6J("ngIf","closed"===e.defaultSegment),t.xp6(2),t.Q6J("disabled",1==e.userSubscription)("disabled",1==e.userSubscription||3==e.userSubscription),t.xp6(1),t.Q6J("ngIf",2==e.userSubscription),t.xp6(1),t.Q6J("ngIf",1==e.userSubscription||3==e.userSubscription),t.xp6(1),t.Q6J("animated",!1))},dependencies:[u.sg,u.O5,p.JJ,p.On,s.YG,s.Sm,s.PM,s.FN,s.wI,s.W2,s.fr,s.gu,s.ju,s.MB,s.pK,s.Q$,s.Nd,s.cJ,s.GO,s.yW,s.sr,s.ki,s.QI,s.j9,v.G,M.f],styles:["ion-segment-button[_ngcontent-%COMP%]{--color: #ffffff80;--background-checked: #000;--color-checked: #000000;--indicator-color: #ffffff}ion-segment[_ngcontent-%COMP%]{--background: #000000;--color: #ffffff80;width:250px;margin:auto}.create-inventory-button[_ngcontent-%COMP%]{--background: #000;--border-radius: 12px;height:46px;text-transform:capitalize}ion-footer[_ngcontent-%COMP%]{border:0px}.inventory-card-item[_ngcontent-%COMP%]{padding:0!important;margin:10px 0!important;height:86px;position:relative}.inventory-delete-button[_ngcontent-%COMP%]{color:red;font-size:26px}.inventory-delete-button-wrapper[_ngcontent-%COMP%]{position:absolute;z-index:10;right:5px;top:5px}ion-modal[_ngcontent-%COMP%]{--height: 264px;--border-radius: 16px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--background: #fff;overflow:auto}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}ion-modal[_ngcontent-%COMP%]::part(backdrop){background:#000000;opacity:.5}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0)}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9;border-radius:6px;border:1px solid #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}ion-modal[_ngcontent-%COMP%]::part(content){--width: 90%;max-width:512px;--border-radius: 6px}ion-footer[_ngcontent-%COMP%]{position:relative;padding-top:20px}.footer-group-button[_ngcontent-%COMP%]{width:100%}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:0;bottom:5px}.create-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.inventory-item-col[_ngcontent-%COMP%]{line-height:12px}.create-lot-button[_ngcontent-%COMP%]{border-radius:6px;--background: #000000;width:144px;height:40px;margin-right:22px}.cancel-lot-button[_ngcontent-%COMP%]{border-radius:6px;width:85px;height:40px}ion-toolbar[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid #eff2f5}"]}),o})()},{path:"lot-list",loadChildren:()=>a.e(8881).then(a.bind(a,8881)).then(o=>o.LotListPageModule)}];let k=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[h.Bz.forChild(J),h.Bz]}),o})();var K=a(1075);let D=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,p.u5,s.Pc,k,K.m]}),o})()}}]);