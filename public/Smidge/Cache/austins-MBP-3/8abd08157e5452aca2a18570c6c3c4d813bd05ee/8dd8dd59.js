(function(){"use strict";function configPullController($scope,uSyncPublishService){function toggleItems(value,content){Object.keys(pvm.items).forEach(key=>{(content||key!=="media"&&key!=="content")&&(pvm.items[key].value=value)})}function InitOptions(){pvm.process.options={removeOrphans:pvm.flags.deleteMissing.value,includeFileHash:pvm.flags.includeFiles.value};pvm.process.items=[{id:item.id,name:contentName,udi:item.udi,flags:uSyncPublishService.getFlags(pvm.flags)}];$scope.vm.options.simple&&(toggleSettings(),toggleContent(),toggleMedia());unsubscribe.push($scope.$watch("pvm.items",function(newVal){newVal!==undefined&&(pvm.process.items=[],angular.forEach(newVal,function(value,key){key==="files"?pvm.process.options.includeFileHash=value.value:key=="systemFiles"?pvm.process.options.includeSystemFileHash=value.value:value.value===!0&&value.typeName!==null&&pvm.process.items.push({udi:"umb://"+value.typeName+"/"+value.root,name:value.typeName,flags:pvm.flagsValue})}),newVal.template.value===!0&&newVal.files.value!==!0&&(newVal.files.value=!0))},!0))}function toggleSettings(){pvm.syncSettings=!pvm.syncSettings;pvm.items.docTypes.value=pvm.syncSettings;pvm.items.dataTypes.value=pvm.syncSettings;pvm.items.mediaTypes.value=pvm.syncSettings;pvm.items.memberTypes.value=pvm.syncSettings;pvm.items.dictionary.value=pvm.syncSettings;pvm.items.macro.value=pvm.syncSettings;pvm.items.template.value=pvm.syncSettings;pvm.items.files.value=pvm.syncSettings;pvm.items.languages.value=pvm.syncSettings;pvm.syncSettings||(pvm.syncMedia&&toggleMedia(),pvm.syncContent&&toggleContent())}function toggleMedia(){pvm.syncMedia=!pvm.syncMedia;pvm.items.media.value=pvm.syncMedia;pvm.syncMedia&&!pvm.syncSettings&&toggleSettings()}function toggleContent(){pvm.syncContent=!pvm.syncContent;pvm.items.content.value=pvm.syncContent;pvm.items.domains.value=pvm.syncContent;pvm.items.protect.value=pvm.syncContent;pvm.syncContent&&!pvm.syncSettings&&toggleSettings()}function toggleMode(){$scope.vm.options.simple=!$scope.vm.options.simple}var unsubscribe=[],pvm=this,emptyGuid,emptyString,item,contentName;pvm.syncSettings=!1;pvm.syncContent=!1;pvm.syncMedia=!1;pvm.mode=$scope.vm.mode;pvm.contentType=$scope.vm.contentType;pvm.process=$scope.vm.process;pvm.flags={includeChildren:{toggle:!0,value:!0},includeDecendants:{toggle:!0,value:!0},includeMedia:{toggle:!1,value:!1},includeLinked:{toggle:!1,value:!1},includeAncestors:{toggle:!1,value:!1},includeDependencies:{toggle:!1,value:!1},includeFiles:{toggle:!1,value:!0},includeMediaFiles:{toggle:!1,value:!1},deleteMissing:{toggle:!1,value:!1},includeSystemFiles:{toggle:!1,value:!1}};pvm.flagsValue=uSyncPublishService.getFlags(pvm.flags);emptyGuid="00000000-0000-0000-0000-000000000000";emptyString="";pvm.items={docTypes:{toggle:!0,value:!0,typeName:"document-type",root:emptyGuid,name:"Document types"},dataTypes:{toggle:!0,value:!0,typeName:"data-type",root:emptyGuid,name:"Data types"},mediaTypes:{toggle:!0,value:!0,typeName:"media-type",root:emptyGuid,name:"Media types"},domains:{toggle:!0,value:!0,typeName:"domain",root:emptyGuid,name:"Domain settings"},memberTypes:{toggle:!0,value:!0,typeName:"member-type",root:emptyGuid,name:"Member types"},dictionary:{toggle:!0,value:!0,typeName:"dictionary-item",root:emptyGuid,name:"Dictionary items"},macro:{toggle:!0,value:!0,typeName:"macro",root:emptyGuid,name:"Macros"},template:{toggle:!0,value:!0,typeName:"template",root:emptyGuid,name:"Templates"},files:{toggle:!0,value:!0,typeName:null,root:emptyString,name:"Files"},systemFiles:{toggle:!0,value:!1,typeName:null,root:emptyString,name:""},languages:{toggle:!0,value:!0,typeName:"language",root:emptyString,name:"Languages"},protect:{toggle:!0,value:!0,typeName:"protect",root:emptyGuid,name:"Public access settings"},content:{toggle:!0,value:!1,typeName:"document",root:emptyGuid,name:"Content"},media:{toggle:!0,value:!1,typeName:"media",root:emptyGuid,name:"Media"},relationTypes:{toggle:!0,value:!0,typeName:"relation-type",root:emptyGuid}};pvm.server=$scope.vm.selectedServer;item=$scope.vm.items[0];contentName=item.name;$scope.vm.headings!==undefined&&($scope.vm.headings.title="PULL settings",$scope.vm.headings.description="PULL settings from "+pvm.server.name);InitOptions();$scope.$on("$destroy",function(){for(var u in unsubscribe)unsubscribe[u]()});pvm.clearAll=function(){toggleItems(!1,!0)};pvm.selectAll=function(){toggleItems(!0,!1)};pvm.toggleSettings=toggleSettings;pvm.toggleContent=toggleContent;pvm.toggleMedia=toggleMedia;pvm.toggleMode=toggleMode}angular.module("umbraco").controller("uSyncPublisherConfigPullController",configPullController)})()