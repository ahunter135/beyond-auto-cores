"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8881],{1253:(v,P,s)=>{s.d(P,{e:()=>h});var _=s(1737),p=s(4850),i=s(7221),f=s(7631),u=s(1102);let h=(()=>{class t{constructor(g){this.rest=g}lotItems(g,C){return this.rest.get({endpoint:`/lots/${g}/items`,params:C}).pipe((0,p.U)(a=>{const{data:c}=a.body;return c})).toPromise()}addCodeToLot(g){return this.rest.post("/lotitems",g).pipe((0,p.U)(C=>{const{data:a}=C.body;return a}),(0,i.K)(C=>(0,_._)(C))).toPromise()}removeCodeInLot(g){return this.rest.delete(`/lotitems/${g}`).pipe((0,p.U)(C=>{const{data:a}=C.body;return a}),(0,i.K)(C=>(0,_._)(C))).toPromise()}lotItemsFullness(g,C){return this.rest.get({endpoint:`/lotitems/${g}/fullness`,params:C}).pipe((0,p.U)(a=>{const{data:c}=a.body;return c})).toPromise()}}return t.\u0275fac=function(g){return new(g||t)(f.LFG(u.v))},t.\u0275prov=f.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},4190:(v,P,s)=>{s.d(P,{s:()=>M});var _=s(4850),p=s(7221),i=s(2868),f=s(591),u=s(1737),h=s(7631),t=s(1102);let M=(()=>{class g{constructor(a){this.rest=a,this.isLoadingMore=!1,this.selectLotStateSubject=new f.X(null)}get selectedLot(){return this.selectLotStateSubject.value}set setSelectedLot(a){this.selectLotStateSubject.next(a)}lots(a){return this.rest.get({endpoint:"/lots",params:a}).pipe((0,_.U)(c=>{const{data:m}=c.body;return m}),(0,p.K)(c=>(0,u._)(c))).toPromise()}inventory(a){return this.rest.get({endpoint:"/lots/inventory",params:a}).pipe((0,_.U)(c=>{const{data:m,pagination:x}=c.body;return{data:m,pagination:x}}),(0,p.K)(c=>(0,u._)(c))).toPromise()}inventorySummary(a){return this.rest.get({endpoint:"/lots/inventorysummary",params:a}).pipe((0,_.U)(c=>{const{data:m,pagination:x}=c.body;return{data:m,pagination:x}}),(0,p.K)(c=>(0,u._)(c))).toPromise()}nextInventory(a){return this.isLoadingMore=!0,this.rest.get({endpoint:a,server:"none"}).pipe((0,_.U)(c=>{const{data:m,pagination:x}=c.body;return{data:m,pagination:x}}),(0,i.b)(()=>this.isLoadingMore=!1),(0,p.K)(c=>(0,u._)(c))).toPromise()}addlot(a){return this.rest.post("/lots",a).pipe((0,_.U)(c=>{const{data:m}=c.body;return m}),(0,p.K)(c=>(0,u._)(c))).toPromise()}updateLot(a){return this.rest.put("/lots",a).pipe((0,_.U)(c=>{const{data:m}=c.body;return m}),(0,p.K)(c=>(0,u._)(c))).toPromise()}deletelot(a){return this.rest.delete(`/lots/${a}`).pipe((0,_.U)(c=>{const{data:m}=c.body;return m}),(0,p.K)(c=>(0,u._)(c))).toPromise()}submitLot(a){return this.rest.post({endpoint:"/lots/submit",params:{lotId:a.lotId,businessName:a.businessName,email:a.email}},a.formData,!1,!0).pipe((0,_.U)(c=>{const{data:m}=c.body;return m}),(0,p.K)(c=>(0,u._)(c))).toPromise()}}return g.\u0275fac=function(a){return new(a||g)(h.LFG(t.v))},g.\u0275prov=h.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"}),g})()},9:(v,P,s)=>{s.d(P,{O:()=>_,q:()=>p});const _=i=>{const f=Math.round(i);return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(f)},p=(i,f)=>parseFloat((f*(i/100)).toFixed(0))},8881:(v,P,s)=>{s.r(P),s.d(P,{LotListPageModule:()=>X});var _=s(6895),p=s(4719),i=s(2478),f=s(1065),u=s(5861),h=s(9),t=s(7631);let M=(()=>{class l{constructor(o){this.modalCtrl=o,this.fullness=100}ngOnInit(){}add(){return this.modalCtrl.dismiss({qty:this.qty,fullness:this.fullness,price:this.price},"add")}onPriceKeyDown(o){("e"===o.key||"."===o.key)&&o.preventDefault()}onInputPrice(o){this.fullness=100,this.fullPrice=0}onBlurPrice(o){this.fullPrice=o.target.value}onChangeFullness(){this.price=(0,h.q)(this.fullness,this.fullPrice)}cancel(){return this.modalCtrl.dismiss(null,"cancel")}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(i.IN))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-add-fullness"]],decls:42,vars:5,consts:[[1,"lot-content"],["mode","ios"],["slot","start"],[1,"paragraph-text-14-bold"],["slot","end"],["color","light",3,"click"],["name","close-outline"],["position","stacked",1,"black-500","paragraph-text-14-bold"],["type","number","placeholder","Input quantity here",1,"lot-input",3,"ngModel","ngModelChange"],["placeholder","Input unit price","type","number",1,"lot-input",3,"ngModel","ngModelChange","keydown","ionBlur","ionInput"],[1,"ion-align-items-center","lot-range"],["mode","ios","min","0","max","100","step","10",3,"pin","ngModel","ngModelChange","ionChange"],["slot","start",1,"black-500"],["slot","end",1,"black-500"],[1,"modal-footer"],[1,"footer-button"],["color","dark",1,"ion-text-capitalize",3,"click"],[1,"add-lot-button",3,"click"],[1,"white"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-content",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-text",3),t._uU(4,"Add Fullness"),t.qZA()(),t.TgZ(5,"ion-buttons",4)(6,"ion-button",5),t.NdJ("click",function(){return n.cancel()}),t._UZ(7,"ion-icon",6),t.qZA()()(),t.TgZ(8,"ion-grid")(9,"ion-row")(10,"ion-col")(11,"ion-label",7),t._uU(12,"Quantity"),t.qZA()()(),t.TgZ(13,"ion-row")(14,"ion-col")(15,"ion-input",8),t.NdJ("ngModelChange",function(r){return n.qty=r}),t.qZA()()(),t.TgZ(16,"ion-row")(17,"ion-col")(18,"ion-label",7),t._uU(19,"Item Price"),t.qZA()()(),t.TgZ(20,"ion-row")(21,"ion-col")(22,"ion-input",9),t.NdJ("ngModelChange",function(r){return n.price=r})("keydown",function(r){return n.onPriceKeyDown(r)})("ionBlur",function(r){return n.onBlurPrice(r)})("ionInput",function(r){return n.onInputPrice(r)}),t.qZA()()(),t.TgZ(23,"ion-row")(24,"ion-col")(25,"ion-label",7),t._uU(26,"Item Fullness %"),t.qZA()()(),t.TgZ(27,"ion-row")(28,"ion-col")(29,"div",10)(30,"ion-range",11),t.NdJ("ngModelChange",function(r){return n.fullness=r})("ionChange",function(){return n.onChangeFullness()}),t.TgZ(31,"ion-text",12),t._uU(32,"0"),t.qZA(),t.TgZ(33,"ion-text",13),t._uU(34,"100"),t.qZA()()()()()(),t.TgZ(35,"ion-footer",14)(36,"div",15)(37,"ion-button",16),t.NdJ("click",function(){return n.cancel()}),t._uU(38,"Cancel"),t.qZA(),t.TgZ(39,"ion-button",17),t.NdJ("click",function(){return n.add()}),t.TgZ(40,"ion-text",18),t._uU(41,"Add fullness"),t.qZA()()()()()),2&o&&(t.xp6(15),t.Q6J("ngModel",n.qty),t.xp6(7),t.Q6J("ngModel",n.price),t.xp6(8),t.Q6J("pin",!0)("ngModel",n.fullness),t.xp6(9),t.uIk("disabled",n.price<0||null==n.price))},dependencies:[p.JJ,p.On,i.YG,i.Sm,i.wI,i.W2,i.fr,i.jY,i.gu,i.pK,i.Q$,i.I_,i.Nd,i.yW,i.sr,i.as,i.QI],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0);padding:13px;border-bottom:1px solid #eff2f5}ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}ion-label[_ngcontent-%COMP%]{padding-bottom:16px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}ion-footer[_ngcontent-%COMP%]{position:relative;padding-top:48px}.footer-toolbar[_ngcontent-%COMP%]{position:relative}.footer-group-button[_ngcontent-%COMP%]{width:100%}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;bottom:5px;height:67px}.add-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}ion-range[_ngcontent-%COMP%]{padding-top:0!important}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}"]}),l})();var g=s(3710);function C(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"div",17),t._UZ(1,"ion-img",18),t.TgZ(2,"ion-icon",19),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.onRemovePhotoGrade())}),t.qZA()()}if(2&l){const o=t.oxw();t.xp6(1),t.Q6J("src",o.currentPhoto.dataUrl)}}function a(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-button",20),t.NdJ("click",function(){t.CHM(o);const e=t.oxw();return t.KtG(e.uploadIdPhoto())}),t.TgZ(1,"div"),t._UZ(2,"ion-icon",21)(3,"br"),t.TgZ(4,"ion-text"),t._uU(5,"Add Photo"),t.qZA()()()}}let c=(()=>{class l{constructor(o,n){this.modalCtrl=o,this.photoService=n,this.businessName=""}ngOnInit(){}uploadIdPhoto(){var o=this;return(0,u.Z)(function*(){const n=yield o.photoService.promptPhoto();o.currentPhoto=n})()}onRemovePhotoGrade(){this.currentPhoto=null}cancel(){return this.modalCtrl.dismiss(null,"cancel")}submit(){return this.modalCtrl.dismiss({businessName:this.businessName,email:this.email,attachment:this.currentPhoto?this.photoService.dataURItoBlob(this.currentPhoto.dataUrl):""},"submit")}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(i.IN),t.Y36(g.T))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-submit-lot"]],decls:38,vars:5,consts:[[1,"lot-content"],["mode","ios"],["slot","start"],[1,"paragraph-text-14-bold"],["slot","end"],["color","light",3,"click"],["name","close-outline"],["position","stacked",1,"black-500","paragraph-text-14-bold"],["placeholder","Input email here","type","email",1,"lot-input",3,"ngModel","ngModelChange"],["placeholder","Input business name here",1,"lot-input",3,"ngModel","ngModelChange"],["class","current-photo-container",4,"ngIf"],["expand","block","color","dark","class","upload-button ion-margin-end",3,"click",4,"ngIf"],[1,"modal-footer"],[1,"footer-button"],["color","dark",1,"ion-text-capitalize",3,"click"],[1,"submit-lot-button",3,"click"],[1,"white"],[1,"current-photo-container"],[1,"id-photo","ion-margin-end",3,"src"],["name","trash","color","danger",1,"trash-icon",3,"click"],["expand","block","color","dark",1,"upload-button","ion-margin-end",3,"click"],["src","/assets/icon/add-photo.svg",1,"add-photo-icon"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-content",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-text",3),t._uU(4,"Submit Lot"),t.qZA()(),t.TgZ(5,"ion-buttons",4)(6,"ion-button",5),t.NdJ("click",function(){return n.cancel()}),t._UZ(7,"ion-icon",6),t.qZA()()(),t.TgZ(8,"ion-grid")(9,"ion-row")(10,"ion-col")(11,"ion-label",7),t._uU(12,"Email"),t.qZA()()(),t.TgZ(13,"ion-row")(14,"ion-col")(15,"ion-input",8),t.NdJ("ngModelChange",function(r){return n.email=r}),t.qZA()()(),t.TgZ(16,"ion-row")(17,"ion-col")(18,"ion-label",7),t._uU(19,"Business Name"),t.qZA()()(),t.TgZ(20,"ion-row")(21,"ion-col")(22,"ion-input",9),t.NdJ("ngModelChange",function(r){return n.businessName=r}),t.qZA()()(),t.TgZ(23,"ion-row")(24,"ion-col")(25,"ion-label",7),t._uU(26,"Identification"),t.qZA()()(),t.TgZ(27,"ion-row")(28,"ion-col"),t.YNc(29,C,3,1,"div",10),t.YNc(30,a,6,0,"ion-button",11),t.qZA()()(),t.TgZ(31,"ion-footer",12)(32,"div",13)(33,"ion-button",14),t.NdJ("click",function(){return n.cancel()}),t._uU(34,"Cancel"),t.qZA(),t.TgZ(35,"ion-button",15),t.NdJ("click",function(){return n.submit()}),t.TgZ(36,"ion-text",16),t._uU(37,"Submit"),t.qZA()()()()()),2&o&&(t.xp6(15),t.Q6J("ngModel",n.email),t.xp6(7),t.Q6J("ngModel",n.businessName),t.xp6(7),t.Q6J("ngIf",n.currentPhoto),t.xp6(1),t.Q6J("ngIf",!n.currentPhoto),t.xp6(5),t.uIk("disabled",!n.email))},dependencies:[_.O5,p.JJ,p.On,i.YG,i.Sm,i.wI,i.W2,i.fr,i.jY,i.gu,i.Xz,i.pK,i.Q$,i.Nd,i.yW,i.sr,i.j9],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0);padding:13px;border-bottom:1px solid #eff2f5}ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}ion-label[_ngcontent-%COMP%]{padding-bottom:16px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}ion-footer[_ngcontent-%COMP%]{position:relative;padding-top:48px}.footer-toolbar[_ngcontent-%COMP%]{position:relative}.footer-group-button[_ngcontent-%COMP%]{width:100%}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;bottom:5px;height:67px}.submit-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}.current-photo-container[_ngcontent-%COMP%]{position:relative}.trash-icon[_ngcontent-%COMP%]{position:absolute;top:2px;left:5px}.id-photo[_ngcontent-%COMP%]{width:104px;height:83px;object-fit:fit}.upload-button[_ngcontent-%COMP%]{width:104px;height:83px}"]}),l})();var m=s(5196),x=s(1253);let A=(()=>{class l{constructor(o,n,e){this.modalCtrl=o,this.loadingCtrl=n,this.lotItemsService=e,this.codeName="",this.price=null,this.fullness=100,this.fullPrice=null}ngOnInit(){}submit(){return this.modalCtrl.dismiss({codeName:this.codeName,price:this.price,fullness:this.fullness,fullPrice:this.fullPrice},"add")}cancel(){return this.modalCtrl.dismiss(null,"cancel")}reset(){this.fullness=100,this.codeName="",this.price=null,this.fullPrice=null}onPriceKeyDown(o){("e"===o.key||"."===o.key)&&o.preventDefault()}onInputPrice(){this.fullness=100,this.fullPrice=0}onBlurPrice(o){this.fullPrice=o.target.value}onChangeFullness(){this.price=(0,h.q)(this.fullness,this.fullPrice)}checkEnterKeyDown(o){13===o.keyCode&&m.N1.hide()}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(i.IN),t.Y36(i.HT),t.Y36(x.e))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-add-code-to-lot"]],decls:42,vars:5,consts:[[1,"lot-content"],["mode","ios",1,"add-code-toolbar"],["slot","start"],[1,"paragraph-text-14-bold"],["slot","end"],["color","light",3,"click"],["name","close-outline"],["position","stacked",1,"black-500","paragraph-text-14-bold"],["placeholder","Input code name",1,"lot-input",3,"ngModel","ngModelChange","keydown"],["placeholder","Input unit price","type","number",1,"lot-input",3,"ngModel","ngModelChange","keydown","ionBlur","ionInput"],["mode","ios","pin","true","min","0","max","100","step","10",3,"ngModel","ngModelChange","ionChange"],["slot","start",1,"black-500"],["slot","end",1,"black-500"],[1,"modal-footer"],[1,"footer-button"],["color","dark",1,"ion-text-capitalize",3,"click"],[1,"paragraph-text-16-semibold"],[1,"add-lot-button",3,"click"],[1,"paragraph-text-16-semibold","white"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-content",0)(1,"ion-toolbar",1)(2,"ion-buttons",2)(3,"ion-text",3),t._uU(4,"Add a Code"),t.qZA()(),t.TgZ(5,"ion-buttons",4)(6,"ion-button",5),t.NdJ("click",function(){return n.cancel()}),t._UZ(7,"ion-icon",6),t.qZA()()(),t.TgZ(8,"ion-grid")(9,"ion-row")(10,"ion-col")(11,"ion-label",7),t._uU(12,"Code"),t.qZA()()(),t.TgZ(13,"ion-row")(14,"ion-col")(15,"ion-input",8),t.NdJ("ngModelChange",function(r){return n.codeName=r})("keydown",function(r){return n.checkEnterKeyDown(r)}),t.qZA()()(),t.TgZ(16,"ion-row")(17,"ion-col")(18,"ion-label",7),t._uU(19,"Item Price"),t.qZA()()(),t.TgZ(20,"ion-row")(21,"ion-col")(22,"ion-input",9),t.NdJ("ngModelChange",function(r){return n.price=r})("keydown",function(r){return n.onPriceKeyDown(r),n.checkEnterKeyDown(r)})("ionBlur",function(r){return n.onBlurPrice(r)})("ionInput",function(){return n.onInputPrice()}),t.qZA()()(),t.TgZ(23,"ion-row")(24,"ion-col")(25,"ion-label",7),t._uU(26,"Item Fullness %"),t.qZA()()(),t.TgZ(27,"ion-row")(28,"ion-col")(29,"ion-range",10),t.NdJ("ngModelChange",function(r){return n.fullness=r})("ionChange",function(){return n.onChangeFullness()}),t.TgZ(30,"ion-text",11),t._uU(31,"0"),t.qZA(),t.TgZ(32,"ion-text",12),t._uU(33,"100"),t.qZA()()()()(),t.TgZ(34,"ion-footer",13)(35,"div",14)(36,"ion-button",15),t.NdJ("click",function(){return n.cancel()}),t.TgZ(37,"ion-text",16),t._uU(38,"Cancel"),t.qZA()(),t.TgZ(39,"ion-button",17),t.NdJ("click",function(){return n.submit()}),t.TgZ(40,"ion-text",18),t._uU(41,"Add to Lot"),t.qZA()()()()()),2&o&&(t.xp6(15),t.Q6J("ngModel",n.codeName),t.xp6(7),t.Q6J("ngModel",n.price),t.xp6(7),t.Q6J("ngModel",n.fullness),t.uIk("disabled",n.price<0||null==n.price),t.xp6(10),t.uIk("disabled",!n.codeName||n.price<0||null==n.price))},dependencies:[p.JJ,p.On,i.YG,i.Sm,i.wI,i.W2,i.fr,i.jY,i.gu,i.pK,i.Q$,i.I_,i.Nd,i.yW,i.sr,i.as,i.QI,i.j9],styles:["ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0)}ion-footer[_ngcontent-%COMP%]{line-height:14px;position:relative}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}.add-code-toolbar[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid #eff2f5}ion-input[_ngcontent-%COMP%]{--background: #f3f7f9;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;bottom:5px;height:67px}.add-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}"]}),l})();var k=s(4190),y=s(1737),I=s(4850),L=s(7221),F=s(1102);let w=(()=>{class l{constructor(o){this.rest=o}createItemFullness(o){return this.rest.post("/lotitemfullness",o).pipe((0,I.U)(n=>{const{data:e}=n.body;return e}),(0,L.K)(n=>(0,y._)(n))).toPromise()}updateItemFullness(o){return this.rest.put("/lotitemfullness",o).pipe((0,I.U)(n=>{const{data:e}=n.body;return e}),(0,L.K)(n=>(0,y._)(n))).toPromise()}removeItemFullness(o){return this.rest.delete(`/lotitemfullness/${o}`).pipe((0,I.U)(n=>{const{data:e}=n.body;return e}),(0,L.K)(n=>(0,y._)(n))).toPromise()}}return l.\u0275fac=function(o){return new(o||l)(t.LFG(F.v))},l.\u0275prov=t.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})();var U=s(5904),N=s(1687);function S(l,d){1&l&&(t.TgZ(0,"div"),t._UZ(1,"app-skeleton-list-loader"),t.qZA())}function E(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-icon",31),t.NdJ("click",function(){t.CHM(o);const e=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.updateQtyItemFullness(e,!0))}),t.qZA()}}function J(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-icon",32),t.NdJ("click",function(){t.CHM(o);const e=t.oxw().$implicit,r=t.oxw(3);return t.KtG(r.removeItemFullness(e.id))}),t.qZA()}}function D(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"div",25)(1,"p",26),t._uU(2),t.qZA(),t.TgZ(3,"p",26),t._uU(4),t.qZA(),t.TgZ(5,"ion-icon",27),t.NdJ("click",function(){const r=t.CHM(o).$implicit,b=t.oxw(3);return t.KtG(b.updateQtyItemFullness(r,!1))}),t.qZA(),t.TgZ(6,"p",28),t._uU(7),t.qZA(),t.YNc(8,E,1,0,"ion-icon",29),t.YNc(9,J,1,0,"ion-icon",30),t.qZA()}if(2&l){const o=d.$implicit,n=t.oxw(3);t.xp6(2),t.hij("",o.fullnessPercentage||0,"%"),t.xp6(2),t.hij(" ",n.formatPrice(o.unitPrice||0)," "),t.xp6(3),t.hij("Qty: ",o.qty||0,""),t.xp6(1),t.Q6J("ngIf",!n.lot.isSubmitted),t.xp6(1),t.Q6J("ngIf",!n.lot.isSubmitted)}}function q(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-button",33),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(3);return t.KtG(e.openModalFullness())}),t._uU(1,"Add New Fullness"),t.qZA()}}const K=function(){return{"object-fit":"cover"}},Y=function(){return{"object-fit":"fill"}};function Q(l,d){if(1&l&&(t.TgZ(0,"ion-accordion",9)(1,"ion-item",10)(2,"div",11),t._UZ(3,"img",12),t.TgZ(4,"div",13)(5,"p"),t._uU(6),t.qZA(),t.TgZ(7,"p",14),t._uU(8),t.qZA()()()(),t.TgZ(9,"div",15)(10,"div",16)(11,"div",17)(12,"p",18),t._uU(13,"% Full"),t.qZA(),t.TgZ(14,"p",18),t._uU(15,"Price"),t.qZA(),t._UZ(16,"p",19),t.TgZ(17,"p",20),t._uU(18,"Quantity"),t.qZA(),t._UZ(19,"p",21)(20,"p",22),t.qZA(),t.YNc(21,D,10,5,"div",23),t.YNc(22,q,2,0,"ion-button",24),t.qZA()()()),2&l){const o=d.$implicit,n=t.oxw(2);t.Q6J("value",o.id),t.xp6(3),t.Q6J("src",o.fileUrl||"/assets/cm-logo-home.svg",t.LSH)("ngStyle",o.fileUrl?t.DdM(8,K):t.DdM(9,Y)),t.xp6(3),t.Oqu(o.converterName||"No Code"),t.xp6(2),t.AsE(" ",n.formatPrice(o.minUnitPrice||0)," - ",n.formatPrice(o.maxUnitPrice||0)," "),t.xp6(13),t.Q6J("ngForOf",n.lotItemsFullness),t.xp6(1),t.Q6J("ngIf",!n.lot.isSubmitted)}}function B(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-accordion-group",7),t.NdJ("ionChange",function(e){t.CHM(o);const r=t.oxw();return t.KtG(r.accordionGroupChange(e))}),t.YNc(1,Q,23,10,"ion-accordion",8),t.qZA()}if(2&l){const o=t.oxw();t.xp6(1),t.Q6J("ngForOf",o.lotItems)}}function j(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"ion-button",42),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(3);return t.KtG(e.submitLot())}),t._UZ(1,"ion-icon",43),t._uU(2," Submit "),t.qZA()}}function z(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"div",38)(1,"ion-button",39),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.openModalCode())}),t._UZ(2,"ion-icon",40),t._uU(3," Add Code "),t.qZA(),t.YNc(4,j,3,0,"ion-button",41),t.qZA()}if(2&l){const o=t.oxw(2);t.xp6(4),t.Q6J("ngIf",o.canInvoice)}}function W(l,d){if(1&l){const o=t.EpF();t.TgZ(0,"div",38)(1,"ion-button",44),t.NdJ("click",function(){t.CHM(o);const e=t.oxw(2);return t.KtG(e.resubmitLot())}),t._UZ(2,"ion-icon",43),t._uU(3," Resubmit "),t.qZA()()}}function R(l,d){if(1&l&&(t.TgZ(0,"div",34)(1,"div",35)(2,"p",36),t._uU(3),t.qZA(),t.TgZ(4,"p"),t._uU(5),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA()(),t.YNc(10,z,5,1,"div",37),t.YNc(11,W,4,0,"div",37),t.qZA()),2&l){const o=t.oxw();t.xp6(3),t.Oqu(o.lot.lotName||"No lot name"),t.xp6(2),t.hij("Quantity: ",o.lot.quantity||0,""),t.xp6(2),t.hij("Average: ",o.formatPrice(o.lot.average||0),""),t.xp6(2),t.hij("Total: ",o.formatPrice(o.lot.total||0),""),t.xp6(1),t.Q6J("ngIf",!o.lot.isSubmitted),t.xp6(1),t.Q6J("ngIf",o.lot.isSubmitted)}}const G=[{path:"",component:(()=>{class l{constructor(o,n,e,r,b,O,T,Z,V,tt){this.lotsService=o,this.lotItemsService=n,this.itemFullnessService=e,this.modalCtrl=r,this.loadingCtrl=b,this.alertCtrl=O,this.accountService=T,this.router=Z,this.toastCtrl=V,this.navCtrl=tt,this.lotItems=[],this.lotItemsFullness=[],this.lotItem2Fullness={},this.isLoading=!1,this.fullness=100,this.codeName="",this.isModalActive=!1,this.showFooter=!0}ngOnInit(){this.onLoad()}onLoad(){var o=this;return(0,u.Z)(function*(){o.canInvoice=o.accountService.currentUser.canInvoice,o.lot=o.lotsService.selectedLot,yield o.fetchLot(),yield o.fetchLotCodes(),yield o.sortLotCodes(),o.lotItems.forEach(function(){var n=(0,u.Z)(function*(e){const r=yield o.lotItemsService.lotItemsFullness(e.id.toString(),{pageNumber:1,pageSize:66955359});o.lotItem2Fullness[e.id]=r});return function(e){return n.apply(this,arguments)}}()),console.log(o.lotItems)})()}fetchLot(o=!0){var n=this;return(0,u.Z)(function*(){n.isLoading=o;const e=yield n.lotsService.inventorySummary({pageNumber:1,pageSize:1,searchCategory:"lotId",searchQuery:n.lot.lotId||n.lot.id});n.lot=e.data[0],n.isLoading=!1})()}fetchLotCodes(){var o=this;return(0,u.Z)(function*(){o.isLoading=!0,o.lotItems=yield o.lotItemsService.lotItems(o.lot.lotId||o.lot.id,{pageNumber:1,pageSize:66955359}),o.isLoading=!1})()}sortLotCodes(){var o=this;return(0,u.Z)(function*(){o.isLoading=!0,o.lotItems.sort(function(n,e){return new Date(e.createdOn).getTime()-new Date(n.createdOn).getTime()}),o.isLoading=!1})()}openModalFullness(){var o=this;return(0,u.Z)(function*(){const n=yield o.modalCtrl.create({component:M,cssClass:"fullness-modal",animated:!1});o.isModalActive=!0,yield n.present();const{data:e,role:r}=yield n.onWillDismiss();if(o.isModalActive=!1,"add"===r){const b=yield o.loadingCtrl.create({message:"Adding to code ..."});b.present(),yield o.itemFullnessService.createItemFullness({fullnessPercentage:e.fullness,qty:e.qty,unitPrice:e.price,lotItemId:o.lotItemId}),o.lotItemsFullness=yield o.lotItemsService.lotItemsFullness(o.lotItemId,{pageNumber:1,pageSize:66955359}),o.fetchLot(),b.dismiss(),yield o.onLoad()}})()}openModalCode(){var o=this;return(0,u.Z)(function*(){const n=yield o.modalCtrl.create({component:A,cssClass:"add-code-to-lot-modal",animated:!1});o.isModalActive=!0,yield n.present();const{data:e,role:r}=yield n.onWillDismiss();o.isModalActive=!1,"add"===r&&(o.fullness=e.fullness,o.codeName=e.codeName,o.price=e.price,o.fullPrice=e.fullPrice,yield o.addCode(),o.reset())})()}accordionGroupChange(o){var n=this;return(0,u.Z)(function*(){const e=o,{detail:r}=e;r.value&&r.value in n.lotItem2Fullness?(n.lotItemId=r.value,n.lotItemsFullness=n.lotItem2Fullness[r.value]):r.value&&(n.lotItemId=r.value,n.lotItemsFullness=yield n.lotItemsService.lotItemsFullness(r.value,{pageNumber:1,pageSize:66955359}))})()}addCode(){var o=this;return(0,u.Z)(function*(){const n=yield o.loadingCtrl.create({message:"Adding to code ..."});n.present(),console.log({lotId:o.lot.lotId||o.lot.id,converterName:o.codeName,originalPrice:o.price,fullnessPercentage:o.fullness}),yield o.lotItemsService.addCodeToLot({lotId:o.lot.lotId||o.lot.id,converterName:o.codeName,originalPrice:o.price,fullnessPercentage:o.fullness}),yield o.fetchLot(),yield o.fetchLotCodes(),yield o.sortLotCodes(),o.modalCtrl.dismiss(),n.dismiss()})()}removeItemFullness(o){var n=this;return(0,u.Z)(function*(){"confirm"===(yield n.presentConfirmationDelete())&&(yield n.itemFullnessService.removeItemFullness(o))&&(n.lotItemsFullness=n.lotItemsFullness.filter(b=>b.id!==o),n.lotItemsFullness.length||(n.fetchLot(),n.fetchLotCodes()))})()}updateQtyItemFullness(o,n){var e=this;return(0,u.Z)(function*(){const r=n?o.qty+1:o.qty-1;r<1?e.removeItemFullness(o.id):(o.qty=r,e.lotItemsFullness=e.lotItemsFullness.map(b=>b.id===o.id?o:b),yield e.itemFullnessService.updateItemFullness({id:o.id,fullnessPercentage:o.fullnessPercentage,lotItemId:o.lotItemId,unitPrice:o.unitPrice,qty:o.qty}),e.fetchLot(!1))})()}presentConfirmationDelete(){var o=this;return(0,u.Z)(function*(){const n=yield o.alertCtrl.create({header:"Are you sure you want to delete ?",cssClass:"confirmation-alert",buttons:[{text:"Cancel",role:"cancel"},{text:"Delete",role:"confirm"}]});yield n.present();const{role:e}=yield n.onDidDismiss();return e})()}resubmitLot(){var o=this;return(0,u.Z)(function*(){yield o.submitLot()})()}submitLot(){var o=this;return(0,u.Z)(function*(){const n=yield o.modalCtrl.create({component:c,cssClass:"submit-lot-modal",animated:!1});yield n.present();const{data:e,role:r}=yield n.onWillDismiss();if(console.log(e),"submit"===r){o.lot.isSubmitted&&(yield o.lotsService.updateLot({id:o.lot.lotId,lotName:o.lot.lotName,isSubmitted:!1}));const b=yield o.loadingCtrl.create({message:"Submitting lot ..."});b.present();const O=new FormData;O.append("attachment",e.attachment),(yield o.lotsService.submitLot({lotId:o.lot.lotId||o.lot.id,businessName:e.businessName,email:e.email,formData:O}))&&(yield(yield o.toastCtrl.create({message:"Successfully submitted lot.",duration:2e3,color:"success"})).present(),yield b.dismiss(),o.navCtrl.pop()),b.dismiss()}})()}reset(){this.fullness=100,this.codeName="",this.price=null,this.fullPrice=null}formatPrice(o){return(0,h.O)(o)}}return l.\u0275fac=function(o){return new(o||l)(t.Y36(k.s),t.Y36(x.e),t.Y36(w),t.Y36(i.IN),t.Y36(i.HT),t.Y36(i.Br),t.Y36(U.B),t.Y36(f.F0),t.Y36(i.yF),t.Y36(i.SH))},l.\u0275cmp=t.Xpm({type:l,selectors:[["app-lot-list"]],decls:11,vars:4,consts:[["mode","ios"],["slot","start"],["mode","md"],[4,"ngIf"],["class","lot-items",3,"ionChange",4,"ngIf"],[1,"spacer"],["class","footer",4,"ngIf"],[1,"lot-items",3,"ionChange"],["class","lot-item",3,"value",4,"ngFor","ngForOf"],[1,"lot-item",3,"value"],["slot","header",1,"ion-no-padding","ion-no-margin","custom-carrot"],[1,"cont"],[1,"lot-img",3,"src","ngStyle"],[1,"header-text"],[1,"bold"],["slot","content",1,"outer"],[1,"content"],[1,"row"],[1,"flex","bold"],[1,"subtract"],[1,"qty","bold","center"],[1,"add"],[1,"trash"],["class","row dashed",4,"ngFor","ngForOf"],["class","bold","expand","block",3,"click",4,"ngIf"],[1,"row","dashed"],[1,"flex"],["src","./assets/icon/minus-qty.svg",1,"subtract",3,"click"],[1,"qty","bold"],["class","add","src","./assets/icon/add-qty.svg",3,"click",4,"ngIf"],["class","trash","name","trash","color","danger",3,"click",4,"ngIf"],["src","./assets/icon/add-qty.svg",1,"add",3,"click"],["name","trash","color","danger",1,"trash",3,"click"],["expand","block",1,"bold",3,"click"],[1,"footer"],[1,"f1"],[1,"lot-name"],["class","f2",4,"ngIf"],[1,"f2"],["color","dark","id","lot-modal",1,"add-code","ion-text-capitalize",3,"click"],["slot","start","src","./assets/icon/add-code.svg"],["class","submit ion-text-capitalize","color","dark",3,"click",4,"ngIf"],["color","dark",1,"submit","ion-text-capitalize",3,"click"],["slot","start","name","checkmark"],["color","dark",1,"add-code","ion-text-capitalize",3,"click"]],template:function(o,n){1&o&&(t.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),t._UZ(3,"ion-back-button",2),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5),t.qZA()()(),t.TgZ(6,"ion-content"),t.YNc(7,S,2,0,"div",3),t.YNc(8,B,2,1,"ion-accordion-group",4),t._UZ(9,"div",5),t.YNc(10,R,12,6,"div",6),t.qZA()),2&o&&(t.xp6(5),t.Oqu(n.lot.lotName),t.xp6(2),t.Q6J("ngIf",n.isLoading),t.xp6(1),t.Q6J("ngIf",!n.isLoading),t.xp6(2),t.Q6J("ngIf",!n.isModalActive&&n.showFooter))},dependencies:[_.sg,_.O5,_.PC,i.We,i.eh,i.oU,i.YG,i.Sm,i.W2,i.Gu,i.gu,i.Ie,i.wd,i.sr,i.cs,N.f],styles:["ion-title[_ngcontent-%COMP%]{text-transform:uppercase;font-size:18px}ion-range[_ngcontent-%COMP%]{padding-top:0}.new-fullness-button[_ngcontent-%COMP%]{--background: #000;--border-radius: 12px;height:46px;text-transform:capitalize}.lot-img[_ngcontent-%COMP%]{width:100px;height:100%}ion-input[_ngcontent-%COMP%]{--background: #fff;border-radius:12px;--padding-start: 10px;--padding-end: 10px;--color: #000}ion-modal[_ngcontent-%COMP%]{--height: 421px;--border-radius: 16px;--box-shadow: 0 10px 15px -3px rgb(0 0 0 / .1), 0 4px 6px -4px rgb(0 0 0 / .1);--background: #fff;overflow:auto}ion-modal[_ngcontent-%COMP%]::part(backdrop){background:#000000;opacity:.5}.lot-content[_ngcontent-%COMP%]::part(background){--background: #fff}ion-modal[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{--background: rgb(255, 255, 255);--color: rgb(0, 0, 0)}.add-code-toolbar[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid #eff2f5}.lot-input[_ngcontent-%COMP%]{--background: #f3f7f9}ion-item[_ngcontent-%COMP%]::part(native){border:0px}ion-label[_ngcontent-%COMP%]{padding-bottom:16px}.lot-range[_ngcontent-%COMP%]{display:flex;width:100%}ion-modal[_ngcontent-%COMP%]::part(content){--width: 90%;max-width:512px;--border-radius: 6px}ion-footer[_ngcontent-%COMP%]{line-height:14px;position:relative}.footer-toolbar[_ngcontent-%COMP%]{position:relative}.footer-group-button[_ngcontent-%COMP%]{width:100%}.footer-button[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;bottom:5px;height:67px}.add-lot-button[_ngcontent-%COMP%]{--background: #000;text-transform:capitalize;height:40px}.border-dash-line[_ngcontent-%COMP%]{border-bottom:1px dashed}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #eff2f5}.col-fix-width[_ngcontent-%COMP%]{flex:auto!important;max-width:none!important;width:100px!important}.lot-items[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;margin:16px}.lot-item[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 4px 8px #ffffff29}.lot-item[_ngcontent-%COMP%]   .cont[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex:1;height:75px}.lot-item[_ngcontent-%COMP%]   .lot-img[_ngcontent-%COMP%]{width:120px;height:100%}.lot-item[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]{display:flex;flex-flow:column;justify-content:center;align-items:center;flex:1;margin:0 28px 0 16px}.lot-item[_ngcontent-%COMP%]   .header-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{text-align:center;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.lot-item[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{padding:16px}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;align-items:center}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .flex[_ngcontent-%COMP%]{flex:2}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .qty[_ngcontent-%COMP%]{width:60px;flex:3;text-align:center}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .subtract[_ngcontent-%COMP%]{width:18px}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .add[_ngcontent-%COMP%]{width:20px}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]   .trash[_ngcontent-%COMP%]{width:20px;margin:0 0 0 16px}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .dashed[_ngcontent-%COMP%]{border-bottom:1px dashed}.lot-item[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--background: black;margin:16px}.lot-item[_ngcontent-%COMP%]   .bold[_ngcontent-%COMP%]{font-weight:700}.lot-item[_ngcontent-%COMP%]::part(header){background:linear-gradient(to left,white,white 55px,black 55px)}.lot-item[_ngcontent-%COMP%]::part(content){background-color:#fff;color:#000}.spacer[_ngcontent-%COMP%]{height:118px}.footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;background:#000;bottom:0;position:fixed;height:118px;width:100vw}.footer[_ngcontent-%COMP%]   .f1[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:16px;font-size:12px}.footer[_ngcontent-%COMP%]   .f1[_ngcontent-%COMP%]   .lot-name[_ngcontent-%COMP%]{font-size:16px;font-weight:700;margin-bottom:8px}.footer[_ngcontent-%COMP%]   .f2[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;flex:1;margin-right:16px}.footer[_ngcontent-%COMP%]   .f2[_ngcontent-%COMP%]   .add-code[_ngcontent-%COMP%]{font-weight:525;margin-right:6px}.footer[_ngcontent-%COMP%]   .f2[_ngcontent-%COMP%]   .submit[_ngcontent-%COMP%]{font-weight:525}"]}),l})()}];let H=(()=>{class l{}return l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[f.Bz.forChild(G),f.Bz]}),l})();var $=s(1075);let X=(()=>{class l{}return l.\u0275fac=function(o){return new(o||l)},l.\u0275mod=t.oAB({type:l}),l.\u0275inj=t.cJS({imports:[_.ez,p.u5,i.Pc,H,$.m]}),l})()},1075:(v,P,s)=>{s.d(P,{m:()=>u});var _=s(6895),p=s(4719),i=s(2478),f=s(7631);let u=(()=>{class h{}return h.\u0275fac=function(M){return new(M||h)},h.\u0275mod=f.oAB({type:h}),h.\u0275inj=f.cJS({imports:[_.ez,p.u5,i.Pc]}),h})()}}]);